# *------------------------------------------------------------------
# | PROGRAM NAME: Approximated Agricultural Demand
# | FILE NAME: Demand_CalcbyServicaArea--Agricultural
# | DATE: 06/05/19
# | CREATED BY:  Jacob Everitt
# *----------------------------------------------------------------
# | PURPOSE:  Develop Approximate Demand Range of usage Agriculture for the Weber
# |Conservancy District.
# |
# |
# *------------------------------------------------------------------
# | STEPS:
# |  0:
# |  1:
# |  2:
# |  3:
# |  4:
# |  5:
# |  6:
# |  7:
# |  8:
# |  9:
# |  10:
# |
# |*------------------------------------------------------------------.
# | DATA USED:
# |
# |https://water.utah.gov/2015WaterData.pdf, December 21, 2018.
# |
# |https://water.utah.gov/OtherReports/MUNICIPAL%20AND%20INDUSTRIAL%20WATER%20USE%20in%20UTAH.pdf, December 21, 2018.
# |
# |https://conservewater.utah.gov/pdf/SamplePlans/WBWCD2013.pdf, December 21, 2018.
# |
# |https://weberbasin.com/, December 21, 2018

# |*------------------------------------------------------------------
# | CONTENTS:
# |  Part 0:
# |  PART 1:
# |  PART 2:
# |  PART 3:
# *-----------------------------------------------------------------
# | UPDATES:
# |
# |
# *------------------------------------------------------------------
### Clear any existing data or functions.
rm(list=ls())
#or not if run directly after Demand_Calc_byServiceArea--Municipal

#Set Working Directory
library(readxl)
setwd("~/GitHub/WeberBasinVulnerability/WeberBasinVulnerability/1 - Scenario Processing/Annual Service Area Demand Scenarios/Input_Data")
DWRSA_Table <- read_excel("DWRSA_Table.xlsx")

#Set Working Directory
setwd("~/GitHub/WeberBasinVulnerability/WeberBasinVulnerability/1 - Scenario Processing/Annual Service Area Demand Scenarios/Output")

##Possible package installation necessary
#install.packages("RColorBrewer")
#install.packages("plotly")
#install.packages("readxl")
#install.packages("openxlsx")
library(readxl)
library(plotly)
library(RColorBrewer)
library(openxlsx)
library("tibble", lib.loc="~/R/win-library/3.5")

##Input Data###############
MI_Same <- read_excel("MI_Same.xlsx")
MI_Same <- data.frame(MI_Same)
MI_Same[20,] <- 0

MI_2015<- read_excel("MI_2015.xlsx")
MI_2070<- read_excel("MI_2070.xlsx")
MI_2150<- read_excel("MI_2150.xlsx")

ddddMI <- read_excel("MI.xlsx")

##Calculation##############
AGtoMI_CF <- c(0.65,0.72,0.78) #Agriculture to Municipal Water Use Conversion Factor
#-Change in Agriculture----------------------

  #MI2070_SamePerCap - MI2015_SamePerCap = Changein_MI
    Changein_MI_2070to2015 = MI_Same$X2070 - MI_Same$X2015
    Changein_MI_2150to2015 = MI_Same$X2150 - MI_Same$X2015
  ##Changein_MI = Changein_AG "0.65AF = 1AF"
  ##Changein_AG = (Changein_MI/0.65)

  #Conversion factor of  0.65
    Changein_AG_2070to2015 = data.frame(Changein_MI_2070to2015/AGtoMI_CF[1])  #**put in while loop for differing conversion factors ?
    Changein_AG_2150to2015 = data.frame(Changein_MI_2150to2015/AGtoMI_CF[1])
  #Conversion factor of  0.72
    Changein_AG_2070to2015[,2] = Changein_MI_2070to2015/AGtoMI_CF[2]
    Changein_AG_2150to2015[,2] = Changein_MI_2150to2015/AGtoMI_CF[2]
  #Conversion factor of 0.78
    Changein_AG_2070to2015[,3] = Changein_MI_2070to2015/AGtoMI_CF[3]
    Changein_AG_2150to2015[,3] = Changein_MI_2150to2015/AGtoMI_CF[3]

#Agricultural Base Usage--------

#BaseDemand <- data.frame(DWRSA_Table$MAX) #MAX AG WATER USE
BaseDemand <- data.frame(DWRSA_Table$AVG)    #OR AVG AG WATER USE
BaseDemand[20,] <- 0

AgBase2015 <- BaseDemand - MI_Same$X2015
#View(AgBase2015)
i=1
AG_2015 <- AgBase2015
AG_2070 <- data.frame(rep(1:20))
AG_2150 <- data.frame(rep(1:20))

while (i<=3) {
AG_2070[,i] <- data.frame(AgBase2015 - Changein_AG_2070to2015[,i])
AG_2150[,i] <- data.frame(AgBase2015 - Changein_AG_2150to2015[,i])
i=i+1
}

AG_2070[,1:3] <- replace(AG_2070[,1:3], AG_2070[,1:3] < 0, 0)
AG_2150[,1:3] <- replace(AG_2150[,1:3], AG_2150[,1:3] < 0, 0)


#ADD AG to MI ###############################
#MI + Base Ag

#2015 BaseDemand

MIandAg_Demand2015 <- data.frame(AG_2015[,1] + MI_2015[,1])
i=1
j=1
  while (i<=ncol(MI_2015)) {
    MIandAg_Demand2015[,j] <- AG_2015[,1] + MI_2015[,i]
    i=i+1
    j=j+1
  }

#View(MIandAg_Demand2015)

#2070
MIandAg_Demand2070 <- data.frame(AG_2070[,1] + MI_2070[,1])
i=1
j=1
k=1
while (k<=3) {
  while (i<=ncol(MI_2070)) {
    MIandAg_Demand2070[,j] <- AG_2070[,k] + MI_2070[,i]
    i=i+1
    j=j+1
  }
  k=k+1
  i=1
}

#View(MIandAg_Demand2070)

#2150

MIandAg_Demand2150 <- data.frame(AG_2150[,1] + MI_2150[,1])
i=1
j=1
k=1
while (k<=3) {
  while (i<=ncol(MI_2150)) {
    MIandAg_Demand2150[,j] <- AG_2150[,k] + MI_2150[,i]
    i=i+1
    j=j+1
  }
  k=k+1
  i=1
}

#View(MIandAg_Demand2150)

#MIandAg_Demand Compilaton

MIandAg_Demand <- data.frame(c(MIandAg_Demand2015,MIandAg_Demand2070,MIandAg_Demand2150))

##Output Data############################################

  write.xlsx(MIandAg_Demand,"MI_with_AG.xlsx")
  #write.csv(MIandAg_Demand,"MI_with_AG.csv")

View(MIandAg_Demand)

#Tab----Workbook-----------
  #Input How Many Scenarios                  #### Nine 2015 Scenarios, Twenty-Seven 2070 Scenarios, and Twenty-Seven 2150 Scenarios
                                                                        #### 65 Total MI plus Ag Scenarios ########
  RunNumber <- 27
  #Create Workbook
  wb <- createWorkbook("Data")
  #Create Worksheet for each Run
  for(Num in 1:(RunNumber)) {
    RunsString <- paste0("Trace",Num)
    addWorksheet(wb, RunsString)
  }
  #Input Data
  SAs<- c('SA1','SA2','SA3','SA4','SA5','SA6','SA7','SA8','SA9','SA10','SA11','SA12','SA13','SA14','SA15','SA16','SA17','SA18','SA19','SA20')
  i=1
  while (i<=RunNumber) {
    writeData(wb,sheet = i, SAs,startCol = 1,startRow = 3)
    i=i+1
  }

  i=1
  while (i<=RunNumber) {
    writeData(wb,sheet = i, MIandAg_Demand[,i],startCol = 2,startRow = 3)
    i=i+1
  }

  ##Save workbook
  saveWorkbook(wb,"MI+AG.xlsx",overwrite = TRUE)

#################################################################################################################################################################################################################################################################################################################################################################################################################################################
### Sum Data for plots ###
#################################################################################################################################################################################################################################################################################################################################################################################################################################################

#MI+Ag_Sums
SummedScenarios <- data.frame("Base","PCDec","PCDD","ETInc","PCDec_ETInc","PCDD_ETInc","ETDec","PCDec_ETDec","PCDD_ETDec")

#2015 Sums
MIAG2015_Sums <- colSums(MIandAg_Demand2015,na.rm = F, dims = 1)
MIAG2015_Sums <- data.frame(MIAG2015_Sums)
#MIAG2015_Sums$AGConversionFactor <- c(rep('65%'))
#MIAG2015_Sums$ET <-  c(rep('SameET',3),rep('DecreaseET',3),rep('IncreaseET',3))
#MIAG2015_Sums$PC <-  rep(c('SamePC','DecreasePC','DrasticDecreasePC'),3)
#MIAG2015_Sums$NUMPC <-  rep(c(3000,2000,1000),3)
#2070 Sums only taking into account 65% Conversion Factor
MIAG2070_Sums <- colSums(MIandAg_Demand2070[,1:9],na.rm = F, dims = 1)
MIAG2070_Sums <- data.frame(MIAG2070_Sums)
#MIAG2070_Sums$AGConversionFactor <- c(rep('65%',9),rep('72%',9),rep('78%',9))
#MIAG2070_Sums$ET <- rep(c(rep('SameET',3),rep('DecreaseET',3),rep('IncreaseET',3)),3)
#MIAG2070_Sums$PC <- rep(rep(c('SamePC','DecreasePC','DrasticDecreasePC'),3),3)
#MIAG2070_Sums$NUMPC <- rep(rep(c(3000,2000,1000),3),3)
#2150 Sums only taking into account 65% Conversion Factor
MIAG2150_Sums <- colSums(MIandAg_Demand2150[,1:9],na.rm = F, dims = 1)
MIAG2150_Sums <- data.frame(MIAG2150_Sums)
#MIAG2150_Sums$AGConversionFactor <- c(rep('65%',9),rep('72%',9),rep('78%',9))
#MIAG2150_Sums$ET <- rep(c(rep('SameET',3),rep('DecreaseET',3),rep('IncreaseET',3)),3)
#MIAG2150_Sums$PC <- rep(rep(c('SamePC','DecreasePC','DrasticDecreasePC'),3),3)
#MIAG2150_Sums$NUMPC <- rep(rep(c(3000,2000,1000),3),3)

SummedScenarios <- data.frame(c(MIAG2015_Sums,MIAG2070_Sums,MIAG2150_Sums))

RowNames <- c("Base","PCDec_ETSame","PCDrD_ETSame","PCBase_ETInc","PCDec_ETInc","PCDrD_ETInc","PCBase_ETDec","PCDec_ETDec","PCDrD_ETDec")

#################################################################################################################################################################################################################################################################################################################################################################################################################################################
### Plots ###
#################################################################################################################################################################################################################################################################################################################################################################################################################################################
#Scenarios Data
#--BarPlots with Agriculture-------------------------------------------------------------

plot_ly(data=SummedScenarios,x=RowNames, y= ~ MIAG2015_Sums ,type = 'bar',name = "2015") %>%
  add_trace(x=RowNames, y= ~ MIAG2070_Sums,name = "2070") %>%
  add_trace(x=RowNames,y = ~ MIAG2150_Sums, name = "2150") %>%
  layout(yaxis=list(title = 'M&I + AG Demand (acre-feet)',barmode = 'group'))







#need to fix all of the references for the plots underneath

Dates <- c("2015", "2070", "2150")

plot_ly(data = SummedScenarios,x = ~Dates,y= ~SS0 ,type = 'bar', name = 'SS0' ) %>%
  add_trace(y = ~SummedScenarios$SS1,name = 'SS1') %>%
  add_trace(y = ~SummedScenarios$SS2,name = 'SS2') %>%
  add_trace(y = ~SummedScenarios$SS3,name = 'SS3') %>%
  add_trace(y = ~SummedScenarios$SS4,name = 'SS4') %>%
  add_trace(y = ~SummedScenarios$SS5,name = 'SS5') %>%
  add_trace(y = ~SummedScenarios$SS6,name = 'SS6') %>%
  add_trace(y = ~SummedScenarios$SS7,name = 'SS7') %>%
  add_trace(y = ~SummedScenarios$SS8,name = 'SS8') %>%
  layout(yaxis=list(title = 'M&I + AG Demand (acre-feet)',barmode = 'group'))


plot_ly(data = SummedScenarios,x = ~Dates,y= ~SS0 ,type = 'bar', name = 'SumDemand:(PerCapita:Same)(ET:Same)' ) %>%
  add_trace(y = ~SummedScenarios$SS1,name = 'SumDemand:(PerCapita:Decrease)(ET:Same)') %>%
  add_trace(y = ~SummedScenarios$SS2,name = 'SumDemand:(PerCapita:DrasticDecrease)(ET:Same)') %>%
  add_trace(y = ~SummedScenarios$SS3,name = 'SumDemand:(PerCapita:Same)(ET:Decrease)') %>%
  add_trace(y = ~SummedScenarios$SS4,name = 'SumDemand:(PerCapita:Decrease)(ET:Decrease)') %>%
  add_trace(y = ~SummedScenarios$SS5,name = 'SumDemand:(PerCapita:DrasticDecrease)(ET:Decrease)') %>%
  add_trace(y = ~SummedScenarios$SS6,name = 'SumDemand:(PerCapita:Same)(ET:Increase)') %>%
  add_trace(y = ~SummedScenarios$SS7,name = 'SumDemand:(PerCapita:Decrease)(ET:Increase)') %>%
  add_trace(y = ~SummedScenarios$SS8,name = 'SumDemand:(PerCapita:DrasticDecrease)(ET:Increase)') %>%
  layout(yaxis=list(title = 'M&I + AG Demand (acre-feet)',barmode = 'group'))

#-Scatter Plots--------------------------------------------------------------------------------------------------------------

plot_ly(data = SummedScenarios,x = ~Dates,y= ~SS0 ,type = 'scatter', name = '(PerCapita:Same)(ET:Same)' ) %>%
  add_trace(y = ~SummedScenarios$SS1,name = '(PerCapita:Decrease)(ET:Same)') %>%
  add_trace(y = ~SummedScenarios$SS2,name = '(PerCapita:DrasticDecrease)(ET:Same)') %>%
  add_trace(y = ~SummedScenarios$SS3,name = '(PerCapita:Same)(ET:Decrease)') %>%
  add_trace(y = ~SummedScenarios$SS4,name = '(PerCapita:Decrease)(ET:Decrease)') %>%
  add_trace(y = ~SummedScenarios$SS5,name = '(PerCapita:DrasticDecrease)(ET:Decrease)') %>%
  add_trace(y = ~SummedScenarios$SS6,name = '(PerCapita:Same)(ET:Increase)') %>%
  add_trace(y = ~SummedScenarios$SS7,name = '(PerCapita:Decrease)(ET:Increase)') %>%
  add_trace(y = ~SummedScenarios$SS8,name = '(PerCapita:DrasticDecrease)(ET:Increase)') %>%
  layout( title = 'Municipal and Agricultural Demands',yaxis=list(title = 'M&I + AG Demand (acre-feet)',barmode = 'group'))

#-Line plots-------------------------------------------------------------------------------------------------------------------

plot_ly(data = SummedScenarios,x = ~Dates,y= ~SS0 ,type = 'scatter',mode = 'line', name = '(PerCapita:Same)(ET:Same)' ) %>%
  add_trace(y = ~SummedScenarios$SS1,name = '(PerCapita:Decrease)(ET:Same)') %>%
  add_trace(y = ~SummedScenarios$SS2,name = '(PerCapita:DrasticDecrease)(ET:Same)') %>%
  add_trace(y = ~SummedScenarios$SS3,name = '(PerCapita:Same)(ET:Decrease)') %>%
  add_trace(y = ~SummedScenarios$SS4,name = '(PerCapita:Decrease)(ET:Decrease)') %>%
  add_trace(y = ~SummedScenarios$SS5,name = '(PerCapita:DrasticDecrease)(ET:Decrease)') %>%
  add_trace(y = ~SummedScenarios$SS6,name = '(PerCapita:Same)(ET:Increase)') %>%
  add_trace(y = ~SummedScenarios$SS7,name = '(PerCapita:Decrease)(ET:Increase)') %>%
  add_trace(y = ~SummedScenarios$SS8,name = '(PerCapita:DrasticDecrease)(ET:Increase)') %>%
  layout( title = 'Municipal and Agricultural Demands',yaxis=list(title = 'M&I + AG Demand (acre-feet)',barmode = 'group'))

#-?? plots--------------------------------------------------------------------------------------------------------------------

plot_ly(data = SummedScenarios,x =1,y= ~SS0 ,type = 'scatter',mode = 'markers', name = '(PerCapita:Same)(ET:Same)' ) %>%
  add_trace(y = ~SummedScenarios$SS1,name = '(PerCapita:Decrease)(ET:Same)') %>%
  add_trace(y = ~SummedScenarios$SS2,name = '(PerCapita:DrasticDecrease)(ET:Same)') %>%
  add_trace(y = ~SummedScenarios$SS3,name = '(PerCapita:Same)(ET:Decrease)') %>%
  add_trace(y = ~SummedScenarios$SS4,name = '(PerCapita:Decrease)(ET:Decrease)') %>%
  add_trace(y = ~SummedScenarios$SS5,name = '(PerCapita:DrasticDecrease)(ET:Decrease)') %>%
  add_trace(y = ~SummedScenarios$SS6,name = '(PerCapita:Same)(ET:Increase)') %>%
  add_trace(y = ~SummedScenarios$SS7,name = '(PerCapita:Decrease)(ET:Increase)') %>%
  add_trace(y = ~SummedScenarios$SS8,name = '(PerCapita:DrasticDecrease)(ET:Increase)') %>%
  layout( title = 'Municipal and Agricultural Demands',yaxis=list(title = 'M&I + AG Demand (acre-feet)',barmode = 'group'))

plot_ly(data = SummedScenarios,x ='Evapotranspiration',y= ~SS0 ,type = 'bar', name = '(PerCapita:Same)(ET:Same)' ) %>%
  add_trace(y = ~SummedScenarios$SS1,name = '(PerCapita:Decrease)(ET:Same)') %>%
  add_trace(y = ~SummedScenarios$SS2,name = '(PerCapita:DrasticDecrease)(ET:Same)') %>%
  add_trace(y = ~SummedScenarios$SS3,name = '(PerCapita:Same)(ET:Decrease)') %>%
  add_trace(y = ~SummedScenarios$SS4,name = '(PerCapita:Decrease)(ET:Decrease)') %>%
  add_trace(y = ~SummedScenarios$SS5,name = '(PerCapita:DrasticDecrease)(ET:Decrease)') %>%
  add_trace(y = ~SummedScenarios$SS6,name = '(PerCapita:Same)(ET:Increase)') %>%
  add_trace(y = ~SummedScenarios$SS7,name = '(PerCapita:Decrease)(ET:Increase)') %>%
  add_trace(y = ~SummedScenarios$SS8,name = '(PerCapita:DrasticDecrease)(ET:Increase)') %>%
  layout( title = 'Municipal and Agricultural Demands',yaxis=list(title = 'M&I + AG Demand (acre-feet)',barmode = 'group'))


#Seperate 2015, 2070, 2150 Data ---------------------------------------------------------------------

plot_ly(data = MIAG2015_Sums,x = 'Year 2015',y= MIAG2015_Sums$MIAG2015_Sums ,type = 'scatter',name = '2015') %>%
    add_trace(x = 'Year 2070', y= ~MIAG2070_Sums$MIAG2070_Sums,name = '2070')%>%
    add_trace(x = 'Year 2150', y= ~MIAG2150_Sums$MIAG2150_Sums,name = '2150')%>%
    layout( title = 'Municipal and Agricultural Demands',yaxis=list(title = 'M&I + AG Demand (acre-feet)',barmode = 'group'))

#4 dimensions #########################################################################
                          # Fix/double check the quantities of and remove legend
  #Fix
 #double check everything
plot_ly(data = MIAG2015_Sums,x = 'Year 2015',y= MIAG2015_Sums$MIAG2015_Sums ,type = 'scatter', mode = 'markers',symbol = MIAG2015_Sums$ET,symbols = c('circle','x','o'), color = MIAG2015_Sums$AGConversionFactor,colors = c("dark red","blue","purple"),name = '65 %',size = MIAG2015_Sums$NUMPC)%>%
  add_trace(x = 'Year 2070',y= MIAG2070_Sums$MIAG2070_Sums ,type = 'scatter', mode = 'markers',symbol = MIAG2070_Sums$ET,symbols = c('circle','x','o'), color = MIAG2070_Sums$AGConversionFactor,colors = c("dark red","blue","purple"),name = '72 %',size = MIAG2070_Sums$NUMPC)%>%
  add_trace(x = 'Year 2150',y= MIAG2150_Sums$MIAG2150_Sums ,type = 'scatter', mode = 'markers',symbol = MIAG2150_Sums$ET,symbols = c('circle','x','o'), color = MIAG2150_Sums$AGConversionFactor,colors = c("dark red","blue","purple"),name = '78 %',size = MIAG2150_Sums$NUMPC)%>%
    layout( title = 'Municipal and Agricultural Demands',yaxis=list(title = 'M&I + AG Demand (acre-feet)',barmode = 'group'))

#HISTORY----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plot_ly(data = MIAG2015_Sums,x = 'Year 2015',y= MIAG2015_Sums$MIAG2015_Sums ,type = 'scatter', mode = 'markers',symbol = MIAG2015_Sums$ET,symbols = c('circle','x','o'),
        color = MIAG2015_Sums$AGConversionFactor,colors = c("dark red","blue","purple"),name = '65 %',sizes = MIAG2015_Sums$PCNUM)%>%
  add_trace(x = 'Year 2070', y= ~MIAG2070_Sums$MIAG2070_Sums,symbol = ~MIAG2070_Sums$ET,color =MIAG2070_Sums$AGConversionFactor,sizes = MIAG2070_Sums$PCNUM,name = list('65','72','78'))%>%
  add_trace(x = 'Year 2150', y= ~MIAG2150_Sums$MIAG2150_Sums,symbol = ~MIAG2150_Sums$ET,color =MIAG2150_Sums$AGConversionFactor,sizes = MIAG2150_Sums$PCNUM,name = list('65','72','78'))%>%
  layout( title = 'Municipal and Agricultural Demands',yaxis=list(title = 'M&I + AG Demand (acre-feet)',barmode = 'group'))

plot_ly(data = MIAG2015_Sums,x = 'Year 2015',y= MIAG2015_Sums$MIAG2015_Sums ,type = 'scatter',symbol = MIAG2015_Sums$ET,symbols = c('circle','x','o'),
        color = MIAG2015_Sums$AGConversionFactor,colors = c("dark red","blue","purple"),name = '65 %')%>%
  add_trace(x = 'Year 2070', y= ~MIAG2070_Sums$MIAG2070_Sums,symbol = ~MIAG2070_Sums$ET,color =MIAG2070_Sums$AGConversionFactor, name = list('65','72','78'))%>%
  add_trace(x = 'Year 2150', y= ~MIAG2150_Sums$MIAG2150_Sums,symbol = ~MIAG2150_Sums$ET,color =MIAG2150_Sums$AGConversionFactor, name = list('65','72','78'))%>%
  layout( title = 'Municipal and Agricultural Demands',yaxis=list(title = 'M&I + AG Demand (acre-feet)',barmode = 'group'))
#------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

  #Selected Scenarios by SUMS---------------------------------------------

MIAG_Sums <- enframe(c(MIAG2015_Sums[7,1],MIAG2015_Sums[6,1],MIAG2070_Sums[25,1],MIAG2070_Sums[6,1],
                       MIAG2150_Sums[25,1],MIAG2150_Sums[6,1]),name = 'CF')
MIAG_Sums$CF <- c('65%','65%','78%','65%','78%','65%')

MIAG2070_Sums


plot_ly(data= MIAG_Sums,x = 'Years',y=MIAG_Sums$value,type = 'scatter',color = MIAG_Sums$CF)%>%
    layout(title = 'Municipal and Agricultural Demands', yaxis =list(title = '(Acre-Feet/Year)',barmode = 'group'))

plot_ly(data= MIAG_Sums,x = 1:6,y=MIAG_Sums$value,type = 'bar',color = MIAG_Sums$CF)%>%
  layout(title = 'Municipal and Agricultural Demands', yaxis =list(title = '(Acre-Feet/Year)'))

plot_ly(data= MIAG_Sums,x = c(2015,2015,2070,2070,2150,2150),y=MIAG_Sums$value,type = 'scatter',color = MIAG_Sums$CF)%>%
  layout(title = 'Municipal and Agricultural Demands', yaxis =list(title = '(Acre-Feet/Year)'))

#Select Data ########################################################################################################################

  #Code for selecting data (Run#s) and writing excel file in correct format

#Outputting Data #############################################################################################################

  # Reset Working directory for outputting selected runs
setwd("~/GitHub/WeberBasinVulnerability/WeberBasinVulnerability/2 - RiverWare Modeling/Hydrology")

  # Output file (MI+AG.xlsx)
