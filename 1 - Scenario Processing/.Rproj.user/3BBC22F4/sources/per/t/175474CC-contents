# *------------------------------------------------------------------
# | PROGRAM NAME: Scenario Comparisons
### Clear any existing data or functions.
rm(list=ls())

#Set Inputting Working Directory
setwd("~/GitHub/WeberBasinVulnerability/WeberBasinVulnerability/3 - Post Processing")

#Inputting factors
  ########################  Flows   ################################
    # a. Paleo Flows
    # b. Historical Gage Flows
    # c. Climate Change Flows

setwd("~/GitHub/WeberBasinVulnerability/WeberBasinVulnerability/2 - RiverWare Modeling/Hydrology")


  ########################  Urban Demands   ################################
    # a. Per-Capita Changes
    # b. Population Changes
    # c. Urban Landscape Evapotranspiration Changes

  ########################  Agricultural Demands   ################################
    # a. Crop Area

  ########################  Reservoir Evaporation  ################################
    # a. Current RiverWare Model Reservoir Evaporation Values
    # b. University of Utah Adjusted Evaporation Values

  ########################  Reservoir Sedimentation  ################################
    # a. Minimum Reservoir Sedimentation
    # b. Maximum Reservoir Sedimenation


#Set Outputting Working Directory
setwd("~/GitHub/WeberBasinVulnerability/WeberBasinVulnerability/3 - Post Processing")

# Create Master Output table

# Plots
 #Input MI+Ag table and Hydrology table used.

require(xlsx)
file.list <- list.files(recursive=T,pattern='*.xlsx')  #get files list from folder

for (i in 1:length(files.list)){
  wb <- loadWorkbook(files.list[i])           #select a file & load workbook
  sheet <- getSheets(wb)                      #get sheet list

  for (j in 1:length(sheet)){
    tmp<-read.xlsx(files.list[i], sheetIndex=j, colIndex= c(1:6,8:10,12:17,19),
                   sheetName=NULL, startRow=4, endRow=NULL,
                   as.data.frame=TRUE, header=F)
    if (i==1&j==1) dataset<-tmp else dataset<-rbind(dataset,tmp)   #happend to previous

  }
}



library(readxl)
MI_AG <- read_excel("MI+AG.xlsx")
#View(MI_AG)

StreamflowData_SelectedScenarios_30years <- read_excel("StreamflowData_SelectedScenarios_30years.xlsx")
View(StreamflowData_SelectedScenarios_30years)
