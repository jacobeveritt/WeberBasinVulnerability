


       #NOTE! WORKING DIRECTORIES ARE NOT SETUP CORRECTLY DUE TO THEM POSSIBLY CHANGING FOR THIS FILE


###############################################################################################################
##Librarys
###############################################################################################################
##Possible package installation necessary
#install.packages("RColorBrewer")
#install.packages("plotly")
#install.packages("readxl")
#install.packages("openxlsx")

library(readxl)
library(plotly)
library(RColorBrewer)
library(openxlsx)

###############################################################################################################
##Inputs##
###############################################################################################################
setwd("~/GitHub/SA_MunicipalDemand_Calc_County/Input_Data")

D2015<-read.csv("2015Data.csv")
D2070<-read.csv("2070Data.csv")
D2150<-read.csv("2150Data.csv")

setwd("~/GitHub/SA_MunicipalDemand_Calc_County/Output")

ResultsTable <- read_excel("Demand_Calc_ResultsTable.xlsx")

###############################################################################################################
## Pull PerCapita Data from Demand_Calc_byServiceArea--Municipal##
###############################################################################################################

 #--------------------------------------------------------------------------------------------------------------
  #PerCapita Values
  #--------------------------------------------------------------------------------------------------------------

  #PerCapita
k=0
while (k<=6) {
  j=0
  while (j<=3) {
    i=2+j+k
    while (i+2<=28) {
      #2015
      #Box Elder County
      ResultsTable[5,i] <- D2015[2,4]
      ResultsTable[6,i] <- D2015[2,5]
      #Davis County
      ResultsTable[7,i] <- D2015[3,4]
      ResultsTable[8,i] <- D2015[3,5]
      #Morgan County
      ResultsTable[9,i] <- D2015[4,4]
      ResultsTable[10,i] <-D2015[4,5]
      #Summit County
      ResultsTable[11,i] <-D2015[5,4]
      ResultsTable[12,i] <-D2015[5,5]
      #Weber County
      ResultsTable[13,i] <-D2015[6,4]
      ResultsTable[14,i] <-D2015[6,5]

      #2070
      #Box Elder County
      ResultsTable[5,i+1] <- D2070[2,4]
      ResultsTable[6,i+1] <- D2070[2,5]
      #Davis County
      ResultsTable[7,i+1] <- D2070[3,4]
      ResultsTable[8,i+1] <- D2070[3,5]
      #Morgan County
      ResultsTable[9,i+1] <- D2070[4,4]
      ResultsTable[10,i+1] <-D2070[4,5]
      #Summit County
      ResultsTable[11,i+1] <-D2070[5,4]
      ResultsTable[12,i+1] <-D2070[5,5]
      #Weber County
      ResultsTable[13,i+1] <-D2070[6,4]
      ResultsTable[14,i+1] <-D2070[6,5]

      #2150
      #Box Elder County
      ResultsTable[5,i+2] <- D2150[2,4]
      ResultsTable[6,i+2] <- D2150[2,5]
      #Davis County
      ResultsTable[7,i+2] <- D2150[3,4]
      ResultsTable[8,i+2] <- D2150[3,5]
      #Morgan County
      ResultsTable[9,i+2] <- D2150[4,4]
      ResultsTable[10,i+2] <-D2150[4,5]
      #Summit County
      ResultsTable[11,i+2] <-D2150[5,4]
      ResultsTable[12,i+2] <-D2150[5,5]
      #Weber County
      ResultsTable[13,i+2] <-D2150[6,4]
      ResultsTable[14,i+2] <-D2150[6,5]

      i=i+9
    }
    #Decreased PerCapita Values
    #Decreasing D2015 Potable by 10%
    D2015$Potable.Use <- D2015$Potable.Use - (D2015$Potable.Use*.10)
    #Decreasing D2070 Secondary by 34%
    D2015$Secondary.Use <- D2015$Secondary.Use - (D2015$Secondary.Use*.34)
    #Decreasing D2070 Potable by 10%
    D2070$Potable.Use <- D2070$Potable.Use - (D2070$Potable.Use*.10)
    #Decreasing D2070 Secondary by 34%
    D2070$Secondary.Use <- D2070$Secondary.Use - (D2070$Secondary.Use*.34)
    #Decreasing D2150 Potable by 10%
    D2150$Potable.Use <- D2150$Potable.Use - (D2150$Potable.Use*.10)
    #Decreasing D2150 Secondary by 34%
    D2150$Secondary.Use <- D2150$Secondary.Use - (D2150$Secondary.Use*.34)
    j=j+3
  }
  #Drastic Decreased PerCapita Values
  #Reset Values
  setwd("~/GitHub/SA_MunicipalDemand_Calc_County/Input_Data")
  D2015<-read.csv("2015Data.csv")
  D2070<-read.csv("2070Data.csv")
  D2150<-read.csv("2150Data.csv")

  #Decreasing D2070 Potable by 20%
  D2070$Potable.Use <- D2070$Potable.Use - (D2070$Potable.Use*.20)
  #Decreasing D2070 Secondary by 44%
  D2070$Secondary.Use <- D2070$Secondary.Use - (D2070$Secondary.Use*.44)
  #Decreasing D2150 Potable by 20%
  D2150$Potable.Use <- D2150$Potable.Use - (D2150$Potable.Use*.20)
  #Decreasing D2150 Secondary by 44%
  D2150$Secondary.Use <- D2150$Secondary.Use - (D2150$Secondary.Use*.44)
  k=k+6
}
#--------------------------------------------------------------------------------------------------------------
#Per Capita Averages
#--------------------------------------------------------------------------------------------------------------
PerCapitaMeans <- colMeans(x=ResultsTable[,2:28],na.rm = TRUE)

i=1
while (i<=28) {
  ResultsTable[15,i+1] <- PerCapitaMeans[i]
  i=i+1
}

#--------------------------------------------------------------------------------------------------------------
#PerCapita Percent Reductions
#--------------------------------------------------------------------------------------------------------------
a=2
b=3
c=4

while ((c+6)<=28) {
  #Same PerCapita Input
  ResultsTable[3:4,a:c] <- "0%"
  #Decrease PerCapita Input
  ResultsTable[3,(a+3):(c+3)] <- "10%"
  ResultsTable[4,(a+3):(c+3)] <- "34%"
  #Drastic Decrease PerCapita Input
  ResultsTable[3,(a+6):(c+6)] <- "20%"
  ResultsTable[4,(a+6):(c+6)] <- "44%"
  a=a+9
  b=b+9
  c=c+9
}

#--------------------------------------------------------------------------------------------------------------
#Population
#--------------------------------------------------------------------------------------------------------------
#Sum Population for Each Year
Sums2015 <- colSums(D2015[2:6,3:5])
Sums2070 <- colSums(D2070[2:6,3:5])
Sums2150 <- colSums(D2150[2:6,3:5])

Population2015 <-Sums2015[1:1]
Population2070 <-Sums2070[1:1]
Population2150 <-Sums2150[1:1]

i=2
while (i+2<=28) {
  #Number of People
  ResultsTable[1,i] <- Population2015
  ResultsTable[1,i+1]<-Population2070
  ResultsTable[1,i+2]<-Population2150

  #Year
  ResultsTable[2,i] <- 2015
  ResultsTable[2,i+1]<-2070
  ResultsTable[2,i+2]<-2150
  i=i+3
}

#--------------------------------------------------------------------------------------------------------------
#
#--------------------------------------------------------------------------------------------------------------


