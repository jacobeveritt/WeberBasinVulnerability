#Output Data Compilation  - No Sedimentation

### Clear any existing data or functions.
rm(list=ls())
library("dplyr", lib.loc="~/R/win-library/3.5")
library(readr)
################################# Input data From Selected Demand Scenarios #################################
setwd("~/GitHub/WeberBasinVulnerability/WeberBasinVulnerability/3 - Post Processing")
    SumMIandAG <- read_csv("SumMIandAG.csv")
    TempTot_Demand <- t(SumMIandAG$SummedMIandAG)
    TempTot_Demand <- data.frame(TempTot_Demand)
Tot_Demand <- c(1:359)
Tot_Demand <- data.frame(seq.Date(as.Date("0000/11/30"),by ="month",length=359))

################################# Input data From RiverWare Scenarios Folder#################################
#Set Working directory
setwd("~/GitHub/WeberBasinVulnerability/WeberBasinVulnerability/2 - RiverWare Modeling/Scenario")

TraceNumber <- 6
TraceNumber1 <-6
Tot_TraceNum <- TraceNumber*TraceNumber1

#Inputs to RiverWare
Tot_Inflow <-read.csv("Trace1,Trace1/Total Inflows.csv")
#Outputs from RiverWare
Tot_Stor <- read.csv("Trace1,Trace1/Total Storage_NO EVAP.csv")
Tot_Shortages <-read.csv("Trace1,Trace1/Total Shortages.csv")

                                      ### Total Demands ###
colnames(Tot_Demand)[1] <- "Date"

i=2
  while (i<=7) {
    Tot_Demand[,i] <- rep(TempTot_Demand[,i-1],359)

    colnames(Tot_Demand)[(i)] <- paste0("Trace",(i-1))
    i=i+1
    }

                                        ### Total Inflows ###
i=1
for(TTNum in 1:TraceNumber){
  for(TNum in 1:TraceNumber1){
    TraceDirectory <- paste0(",Trace",TNum)
    TraceDirectory <-paste0 (TraceDirectory,"/Total Inflows.csv")
    TraceNum1<- paste0("Trace",TTNum)
    TraceDirectory <- paste0(TraceNum1,TraceDirectory)

      Location <- TraceDirectory
      Temp_Inflows <- read_csv(Location)
      Tot_Inflow[,i] <- Temp_Inflows[,5]
      i=i+1
    }
  }

Tot_Inflow <- data.frame(Tot_Inflow)

#add Date column
Tot_Inflow$Date <- seq.Date(as.Date("0000/11/30"),by ="month",length=359)
#View(Tot_Inflow)

                                      ### Total Storage ###
i=1
for(TTNum in 1:TraceNumber){
  for(TNum in 1:TraceNumber1){
      TraceDirectory <- paste0(",Trace",TNum)
      TraceDirectory <-paste0 (TraceDirectory,"/Total Storage_NO EVAP.csv")
      TraceNum1<- paste0("Trace",TTNum)
      TraceDirectory <- paste0(TraceNum1,TraceDirectory)

      Location <- TraceDirectory
      Temp_Storage <- read_csv(Location)
      Tot_Stor[,i] <- Temp_Storage[,5]
      i=i+1
    }
  }

Tot_Stor <- data.frame(Tot_Stor)

#add Date column
Tot_Stor$Date <- seq.Date(as.Date("0000/11/30"),by ="month",length=359)
#View(Tot_Stor)

                                  ### Total Shortages ###
i=1
for(TTNum in 1:TraceNumber){
  for(TNum in 1:TraceNumber1){
      TraceDirectory <- paste0(",Trace",TNum)
      TraceDirectory <-paste0 (TraceDirectory,"/Total Shortages.csv")
      TraceNum1<- paste0("Trace",TTNum)
      TraceDirectory <- paste0(TraceNum1,TraceDirectory)

      Location <- TraceDirectory
      Temp_Storage <- read_csv(Location)
      Tot_Shortages[,i] <- Temp_Storage[,5]
      i=i+1
    }
  }

Tot_Shortages <- data.frame(Tot_Shortages)

#add Date column
Tot_Shortages$Date <- seq.Date(as.Date("0000/11/30"),by ="month",length=359)
#View(Tot_Shortages)


###########################------------Rename Columns--------------------####################################
    ### Total Inflows ###
i=1
for(TTNum in 1:TraceNumber){
  for(TNum in 1:TraceNumber1){
      TraceDirectory <- paste0(",Trace",TNum)
      TraceNum1<- paste0("Inflows Trace",TTNum)
      TraceDirectory <- paste0(TraceNum1,TraceDirectory)

      colnames(Tot_Inflow)[i] <-  TraceDirectory
      i=i+1
    }
  }

      ### Total Storage ###
i=1
for(TTNum in 1:TraceNumber){
  for(TNum in 1:TraceNumber1){
      TraceDirectory <- paste0(",Trace",TNum)
      TraceNum1<- paste0("Storage Trace",TTNum)
      TraceDirectory <- paste0(TraceNum1,TraceDirectory)

      colnames(Tot_Stor)[i] <-  TraceDirectory
      i=i+1
    }
  }

### Total Shortages ###
i=1
for(TTNum in 1:TraceNumber){
  for(TNum in 1:TraceNumber1){
      TraceDirectory <- paste0(",Trace",TNum)
      TraceNum1<- paste0("Shortages Trace",TTNum)
      TraceDirectory <- paste0(TraceNum1,TraceDirectory)

      colnames(Tot_Shortages)[i] <-  TraceDirectory
      i=i+1
    }
  }


################################--------------------Merge DataFrames-------------------------################

tempfile <- merge(Tot_Inflow,Tot_Demand,by="Date")
tempfile <- merge(Tot_Inflow,Tot_Stor,by="Date")
tempfile <- merge(tempfile,Tot_Shortages,by="Date")
AllData <- merge(tempfile,Tot_Sedimentation,by="Date")

