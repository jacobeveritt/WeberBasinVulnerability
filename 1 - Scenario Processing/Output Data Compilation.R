#Output Data Compilation

### Clear any existing data or functions.
rm(list=ls())
## Linear Average looking forward

###Total Storage Compilation#--------------------------------------------------------------------------------#

setwd("~/GitHub/WeberBasinVulnerability/WeberBasinVulnerability/2 - RiverWare Modeling/Scenario")
library(readr)
Total_Storage_NO_EVAP <- read_csv("Trace5,Trace3,RiverWare MRM,Weber Basin RiverWare Model,RiverWare Policy/Total Storage_NO EVAP.csv")
#View(Total_Storage_NO_EVAP)

#Plots
####-----------------------------Line Plots--------------------------------------------------
#library(plotly)
#x<-c(1:359)
#y<- Total_Storage_NO_EVAP[,5]
#data <- data.frame(x,y)
#p<- plot_ly(data,x=~x,y=~Slot.Value,type = 'scatter', mode = 'lines') %>%
 # layout(yaxis = list(title = 'Total Storage'))
#p

#Create a loop
  #input data
TraceNumber <- 6
TraceNumber1 <-6
Tot_TraceNum <- TraceNumber*TraceNumber1

Tot_Stor <- read.csv("Trace1,Trace1,RiverWare MRM,Weber Basin RiverWare Model,RiverWare Policy/Total Storage_NO EVAP.csv")

  #Create TraceFolder Naming lookup for Values with No Evap.
  i=1
  for(TTNum in 1:TraceNumber){
    for(TNum in 1:TraceNumber1){

    TraceDirectory <- paste0(",Trace",TTNum)
    TraceDirectory <-paste0 (TraceDirectory,",RiverWare MRM,Weber Basin RiverWare Model,RiverWare Policy/Total Storage_NO EVAP.csv")
    TraceNum1<- paste0("Trace",TNum)
    TraceDirectory <- paste0(TraceNum1,TraceDirectory)
    Location <- TraceDirectory

    Temp_Storage <- read_csv(Location)

    Tot_Stor[,i] <- Temp_Storage[,5]
    i=i+1
  }
  }

  Tot_Stor <- data.frame(Tot_Stor)

#rename columns
  i=1
  TTNum <- 1
  TNum <- 1
while (i<=Tot_TraceNum) {

  TraceNum1 <- paste0("Trace",TNum)
  TraceNum2<- paste0(",Trace",TTNum)
  TraceDirectory <- paste0(TraceNum1,TraceNum2)

  colnames(Tot_Stor)[i] <-  TraceDirectory

  #Tot_Stor[,i] <- setNames(Tot_Stor[,i], TraceDirectory)

i=i+1
if(TTNum > (TraceNumber-1)){
  TNum = TNum +1
} else {
  TNum = TNum
}

if(TTNum > (TraceNumber1-1)){
  TTNum = 1
} else {
  TTNum = TTNum + 1
}
}

#add Date column
  Tot_Stor$Date <- seq.Date(as.Date("0000/11/30"),by ="month",length=359)

  #View(Tot_Stor)

##  ####plot data##---------------------------------------------------------------------------------

#Line plots
  #Loop                   #Get rid of Alpha line??
  #different Colors
  library(plotly)

  p<- plot_ly(Tot_Stor, x = Tot_Stor$Date, name = 'Base', type = 'scatter', mode = 'lines',
              line = list(color = colors(distinct = F), width = 2)) %>%
    layout(title = "Monthly Storage",
      xaxis = list(title ="Time"),
      yaxis = list(title = "Storage (Acre-Feet)"))

  for(trace in colnames(Tot_Stor)){
    p <- p %>% plotly::add_trace(y = as.formula(paste0("~`",trace,"`")),name = trace)
  }
  p


## Average Annual Storage ### By Water Year November to October
  Tot_Stor_Avg_Annual <-1:30
  Tot_Stor_Avg_Annual <- data.frame(Tot_Stor_Avg_Annual)

  k=1
  while (k<=36) {
    i=1
    j=12
    while (i<=30) {
      Tot_Stor_Avg_Annual[i,k] <- mean(na.omit(Tot_Stor[(j-11):j,k]))
      i=i+1
      j=j+12
    }
    k=k+1
  }

View(Tot_Stor_Avg_Annual)

#rename columns
i=1
TTNum <- 1
TNum <- 1
while (i<=Tot_TraceNum) {

  TraceNum1 <- paste0("Trace",TNum)
  TraceNum2<- paste0(",Trace",TTNum)
  TraceDirectory <- paste0(TraceNum1,TraceNum2)

  colnames(Tot_Stor_Avg_Annual)[i] <-  TraceDirectory

  i=i+1
  if(TTNum > (TraceNumber-1)){
    TNum = TNum +1
  } else {
    TNum = TNum
  }

  if(TTNum > (TraceNumber1-1)){
    TTNum = 1
  } else {
    TTNum = TTNum + 1
  }
}


#add Date column
Tot_Stor_Avg_Annual$Year <- seq.Date(as.Date("0000/11/30"),by ="year",length=30)

#Multiline plot Average Annual Storage

#Line plot
#Loop                   #Get rid of Base line??
#different Colors
library(plotly)

p<- plot_ly(Tot_Stor_Avg_Annual, x = Tot_Stor_Avg_Annual$Year, name = 'Base', type = 'scatter', mode = 'lines',
            line = list(color = colors(distinct = F), width = 2)) %>%
  layout(title = "Average Annual Storage",
    xaxis = list(title ="Time"),
    yaxis = list(title = "Storage (Acre-Feet)"))

for(trace in colnames(Tot_Stor_Avg_Annual)){
  p <- p %>% plotly::add_trace(y = as.formula(paste0("~`",trace,"`")),name = trace)
}
p



#Extra Plots
  # #-------------------------------------------
lp

  lp <- plot_ly(data,x=~x,y=Tot_Stor[,1],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp

  lp <- plot_ly(data,x=~x,y=Tot_Stor[,2],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp

  lp <- plot_ly(data,x=~x,y=Tot_Stor[,3],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp
  lp <- plot_ly(data,x=~x,y=Tot_Stor[,4],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp
  lp <- plot_ly(data,x=~x,y=Tot_Stor[,5],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp
  lp <- plot_ly(data,x=~x,y=Tot_Stor[,6],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp
  lp <- plot_ly(data,x=~x,y=Tot_Stor[,7],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp
  lp <- plot_ly(data,x=~x,y=Tot_Stor[,8],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp
  lp <- plot_ly(data,x=~x,y=Tot_Stor[,9],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp
  lp <- plot_ly(data,x=~x,y=Tot_Stor[,10],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp
  lp <- plot_ly(data,x=~x,y=Tot_Stor[,11],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp
  lp <- plot_ly(data,x=~x,y=Tot_Stor[,12],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp
  lp <- plot_ly(data,x=~x,y=Tot_Stor[,13],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp
  lp <- plot_ly(data,x=~x,y=Tot_Stor[,14],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp
  lp <- plot_ly(data,x=~x,y=Tot_Stor[,15],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp
  lp <- plot_ly(data,x=~x,y=Tot_Stor[,16],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp
  lp <- plot_ly(data,x=~x,y=Tot_Stor[,17],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp
  lp <- plot_ly(data,x=~x,y=Tot_Stor[,18],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp
  lp <- plot_ly(data,x=~x,y=Tot_Stor[,19],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp
  lp <- plot_ly(data,x=~x,y=Tot_Stor[,20],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp
  lp <- plot_ly(data,x=~x,y=Tot_Stor[,21],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp
  lp <- plot_ly(data,x=~x,y=Tot_Stor[,22],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp
  lp <- plot_ly(data,x=~x,y=Tot_Stor[,23],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp
  lp <- plot_ly(data,x=~x,y=Tot_Stor[,24],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp
  lp <- plot_ly(data,x=~x,y=Tot_Stor[,25],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp
  lp <- plot_ly(data,x=~x,y=Tot_Stor[,26],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp
  lp <- plot_ly(data,x=~x,y=Tot_Stor[,27],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp
  lp <- plot_ly(data,x=~x,y=Tot_Stor[,28],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp
  lp <- plot_ly(data,x=~x,y=Tot_Stor[,29],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp
  lp <- plot_ly(data,x=~x,y=Tot_Stor[,30],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp
  lp <- plot_ly(data,x=~x,y=Tot_Stor[,31],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp
  lp <- plot_ly(data,x=~x,y=Tot_Stor[,32],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp
  lp <- plot_ly(data,x=~x,y=Tot_Stor[,33],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp
  lp <- plot_ly(data,x=~x,y=Tot_Stor[,34],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp
  lp <- plot_ly(data,x=~x,y=Tot_Stor[,35],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp
  lp <- plot_ly(data,x=~x,y=Tot_Stor[,36],type = 'scatter', mode = 'lines')%>%
    layout(yaxis = list(title = 'Total Storage'))

  lp

    #Parallel plots
  df <- Tot_Stor

  Pp <-df %>%
    plot_ly(type = 'parcoords', x=
            dimensions = list(
              list(range =c(1000,5000)),
              label = 'Storage', values = Storage_Combined
            )
    )

  ################## INPUT Storage data with Evap










































##############Old Code ################################## if I have time#############################
###----------------------------Parallel Plots------------------------------------------------
library(plotly)

#Res Elevations
#Res_Elev[,37:38] <- Reservoir_Elevations_Combined[1:2872,3:4]

#df <-Res_Elev

#Pp <- df %>%
 # plot_ly(type = 'parcoords',
  #          dimensions = list(
   #         list(range = c(3500,8500),
    #             label = 'Res Elev 1', values = Res_Elev[1:10,1]),
     #       list(range = c(4000,8500),
      #           constraintrange = c(4500,6500),
       #          label = 'Res_Elev 2', values = Res_Elev[1:10,2])
        #  )
  #)

#Storage
#df <- Storage_Combined

#Pp <-df %>%
 # plot_ly(type = 'parcoords',
  #        dimensions = list(
   #         list(range =c(1000,5000)),
    #        label = 'Storage', values = Storage_Combined
     #     )
      #    )

## ------------ title = 'Smith and Morehouse Reservoir'  -------

#Pp <- df %>%
#plot_ly(type = 'parcoords',
#dimensions = list(
#list(range = c(7640,7690),
#label = 'T1T1', values = Res_Elev[1:359,1]),
#list(range = c(7640,7690),
#label = 'T1T2', values = Res_Elev[1:359,2]),
#list(range = c(7640,7690),
#label = 'T1T3', values = Res_Elev[1:359,3]),
#list(range = c(7640,7690),
#label = 'T1T4', values = Res_Elev[1:359,4]),
#list(range = c(7640,7690),
#label = 'T1T5', values = Res_Elev[1:359,5]),
#list(range = c(7640,7690),
#label = 'T1T6', values = Res_Elev[1:359,6]),
#list(range = c(7640,7690),
#label = 'T2T1', values = Res_Elev[1:359,7]),
#list(range = c(7640,7690),
#label = 'T2T2', values = Res_Elev[1:359,8]),
#list(range = c(7640,7690),
#label = 'T2T3', values = Res_Elev[1:359,9]),
#list(range = c(7640,7690),
#label = 'T2T4', values = Res_Elev[1:359,10]),
#list(range = c(7640,7690),
#label = 'T2T5', values = Res_Elev[1:359,11]),
#list(range = c(7640,7690),
#label = 'T2T6', values = Res_Elev[1:359,12]),
#list(range = c(7640,7690),
#label = 'T3T1', values = Res_Elev[1:359,13]),
#list(range = c(7640,7690),
#label = 'T3T2', values = Res_Elev[1:359,14]),
#list(range = c(7640,7690),
#label = 'T3T3', values = Res_Elev[1:359,15]),
#list(range = c(7640,7690),
#label = 'T3T4', values = Res_Elev[1:359,16]),
#list(range = c(7640,7690),
#label = 'T3T5', values = Res_Elev[1:359,17]),
#list(range = c(7640,7690),
#label = 'T3T6', values = Res_Elev[1:359,18]),
#list(range = c(7640,7690),
#label = 'T4T1', values = Res_Elev[1:359,19]),
#list(range = c(7640,7690),
#label = 'T4T2', values = Res_Elev[1:359,20]),
#list(range = c(7640,7690),
#label = 'T4T3', values = Res_Elev[1:359,21]),
#list(range = c(7640,7690),
#label = 'T4T4', values = Res_Elev[1:359,22]),
#list(range = c(7640,7690),
#label = 'T4T5', values = Res_Elev[1:359,23]),
#list(range = c(7640,7690),
#label = 'T4T6', values = Res_Elev[1:359,24]),
#list(range = c(7640,7690),
#label = 'T5T1', values = Res_Elev[1:359,25]),
#list(range = c(7640,7690),
#label = 'T5T2', values = Res_Elev[1:359,26]),
#list(range = c(7640,7690),
#label = 'T5T3', values = Res_Elev[1:359,27]),
#list(range = c(7640,7690),
#label = 'T5T4', values = Res_Elev[1:359,28]),
#list(range = c(7640,7690),
#label = 'T5T5', values = Res_Elev[1:359,29]),
#list(range = c(7640,7690),
#label = 'T5T6', values = Res_Elev[1:359,30]),
#list(range = c(7640,7690),
#label = 'T6T1', values = Res_Elev[1:359,31]),
#list(range = c(7640,7690),
#label = 'T6T2', values = Res_Elev[1:359,32]),
#list(range = c(7640,7690),
#label = 'T6T3', values = Res_Elev[1:359,33]),
#list(range = c(7640,7690),
#label = 'T6T4', values = Res_Elev[1:359,34]),
#list(range = c(7640,7690),
#label = 'T6T5', values = Res_Elev[1:359,35]),
#list(range = c(7640,7690),
#label = 'T6T6', values = Res_Elev[1:359,36])
#)
#)

#Pp

## ------------ title = 'Rockport Reservoir'  -------

#Pp <- df %>%
#  plot_ly(type = 'parcoords',
 #         dimensions = list(
  #          list(range = c(5000,6100),
   #              label = 'T1T1', values = Res_Elev[360:719,1]),
  #          list(range = c(5000,6100),
   #              label = 'T1T2', values = Res_Elev[360:719,2]),
    #        list(range = c(5000,6100),
     #            label = 'T1T3', values = Res_Elev[360:719,3]),
      #      list(range = c(5000,6100),
       #          label = 'T1T4', values = Res_Elev[360:719,4]),
        #    list(range = c(5000,6100),
         #        label = 'T1T5', values = Res_Elev[360:719,5]),
          #  list(range = c(5000,6100),
           #      label = 'T1T6', values = Res_Elev[360:719,6]),
            #list(range = c(5000,6100),
             #    label = 'T2T1', values = Res_Elev[360:719,7]),
      #      list(range = c(5000,6100),
       #          label = 'T2T2', values = Res_Elev[360:719,8]),
        #    list(range = c(5000,6100),
         #        label = 'T2T3', values = Res_Elev[360:719,9]),
          #  list(range = c(5000,6100),
           #      label = 'T2T4', values = Res_Elev[360:719,10]),
            #list(range = c(5000,6100),
             #    label = 'T2T5', values = Res_Elev[360:719,11]),
    #        list(range = c(5000,6100),
     #            label = 'T2T6', values = Res_Elev[360:719,12]),
      #      list(range = c(5000,6100),
       #          label = 'T3T1', values = Res_Elev[360:719,13]),
        #    list(range = c(5000,6100),
         #        label = 'T3T2', values = Res_Elev[360:719,14]),
          #  list(range = c(5000,6100),
           #      label = 'T3T3', values = Res_Elev[360:719,15]),
            #list(range = c(5000,6100),
             #    label = 'T3T4', values = Res_Elev[360:719,16]),
    #        list(range = c(5000,6100),
     #            label = 'T3T5', values = Res_Elev[360:719,17]),
      #      list(range = c(5000,6100),
       #          label = 'T3T6', values = Res_Elev[360:719,18]),
        #    list(range = c(5000,6100),
         #        label = 'T4T1', values = Res_Elev[360:719,19]),
          #  list(range = c(5000,6100),
           #      label = 'T4T2', values = Res_Elev[360:719,20]),
            #list(range = c(5000,6100),
             #    label = 'T4T3', values = Res_Elev[360:719,21]),
            #list(range = c(5000,6100),
             #    label = 'T4T4', values = Res_Elev[360:719,22]),
  #          list(range = c(5000,6100),
   #              label = 'T4T5', values = Res_Elev[360:719,23]),
    #        list(range = c(5000,6100),
     #            label = 'T4T6', values = Res_Elev[360:719,24]),
      #      list(range = c(5000,6100),
       #          label = 'T5T1', values = Res_Elev[360:719,25]),
        #    list(range = c(5000,6100),
         #        label = 'T5T2', values = Res_Elev[360:719,26]),
          #  list(range = c(5000,6100),
           #      label = 'T5T3', values = Res_Elev[360:719,27]),
            #list(range = c(5000,6100),
            #     label = 'T5T4', values = Res_Elev[360:719,28]),
            #list(range = c(5000,6100),
             #    label = 'T5T5', values = Res_Elev[360:719,29]),
#            list(range = c(5000,6100),
 #                label = 'T5T6', values = Res_Elev[360:719,30]),
  #          list(range = c(5000,6100),
   #              label = 'T6T1', values = Res_Elev[360:719,31]),
    #        list(range = c(5000,6100),
     #            label = 'T6T2', values = Res_Elev[360:719,32]),
      #      list(range = c(5000,6100),
       #          label = 'T6T3', values = Res_Elev[360:719,33]),
        #    list(range = c(5000,6100),
         #        label = 'T6T4', values = Res_Elev[360:719,34]),
          #  list(range = c(5000,6100),
           #      label = 'T6T5', values = Res_Elev[360:719,35]),
            #list(range = c(5000,6100),
             #    label = 'T6T6', values = Res_Elev[360:719,36])
          #)
  #)

#Pp



##------ CSV combiled outside or RiverWare (Has problems) --------------------------------------------------


#Input data from RiverWare Outputs

#setwd("~/GitHub/WeberBasinVulnerability/WeberBasinVulnerability/2 - RiverWare Modeling/Scenario")

#File Folder Directory lookup

#Trace1,Trace1,RiverWare MRM,Weber Basin RiverWare Model,RiverWare Policy

#Format for output file
#Reservoir_Elevations <- read.csv("Trace1,Trace1,RiverWare MRM,Weber Basin RiverWare Model,RiverWare Policy/Reservoir Elevations.csv")

#Annual_Demands <- read.csv("Trace1,Trace1,RiverWare MRM,Weber Basin RiverWare Model,RiverWare Policy/Reservoir Elevations.csv")

#Create TraceFolder Naming lookup

#TraceNumber <- 6  # number of traces considered,  possibly write a code to count
#TraceNumber1 <- 6  # number of traces considered,  possibly write a code to count
#TotalTraces <- TraceNumber*TraceNumber1

#for(TTNum in 1:(TotalTraces)){
 # for(TNum in 1:(TraceNumber)) {

  #  TraceDirectory0 <- paste0("Trace",TraceNumber)

   # for(TNum1 in 1:(TraceNumber1)) {
    #  TraceDirectory <- paste0(TraceDirectory0,",Trace",TNum1)
    #  TraceDirectory <-paste0 (TraceDirectory,",RiverWare MRM,Weber Basin RiverWare Model,RiverWare Policy/Reservoir Elevations.csv")
     # R_E <- read.csv(TraceDirectory)
    #  Reservoir_Elevations[,TTNum] <- R_E[,5]
    #}
  #}
#}
#View(Reservoir_Elevations)

#TraceNumber <- 4  # number of traces considered,  possibly write a code to count
#TraceNumber1 <- 4  # number of traces considered,  possibly write a code to count
#TotalTraces <- TraceNumber*TraceNumber1

#for(TTNum in 1:(TotalTraces)){
 # for(TNum in 1:(TraceNumber)) {

  #  TraceDirectory0 <- paste0("Trace",TraceNumber)

   # for(TNum1 in 1:(TraceNumber1)) {
    #  TraceDirectory <- paste0(TraceDirectory0,",Trace",TNum1)
     # TraceDirectory <-paste0 (TraceDirectory,",RiverWare MRM,Weber Basin RiverWare Model,RiverWare Policy/Annual Demands.csv")
      #A_D <- read.csv(TraceDirectory)
      #Annual_Demands[,TTNum] <- R_E[,5]
  #  }
#  }
#}

#View(Annual_Demands)


#Clean up Data (Delete Zeros)
