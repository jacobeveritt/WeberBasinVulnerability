DecSecondary <- (1 - 0.34)
#2015
D2015$DecSecondary.Use <- D2015$Secondary.Use * DecSecondary
#2070
D2070$DecSecondary.Use <- D2070$Secondary.Use * DecSecondary
#2150
D2150$DecSecondary.Use <- D2150$Secondary.Use * DecSecondary
######Calculate Demand Decreased Values###########################################################################################
#Calculate Demand by County For 2015, 2070 and 2150
#2015
D2015$MI_County_PCDec <- ((D2015$Population*D2015$DecPotable.Use) + (D2015$Population*D2015$DecSecondary.Use))*GALtoAF
#2070
D2070$MI_County_PCDec <- ((D2070$Population*D2070$DecPotable.Use) + (D2070$Population*D2070$DecSecondary.Use))*GALtoAF
#2150
D2150$MI_County_PCDec <- ((D2150$Population*D2150$DecPotable.Use) + (D2150$Population*D2150$DecSecondary.Use))*GALtoAF
###Allocating Demand from County Demand to Service Area Proportionally From DWRSA_Table
#2015
D2015$MI_SA_PCDec <- D2015$MI_County_PCDec*(DWRSA_Table$AVG/DWRSA_Table$`SUMS by County`)
#2070
D2070$MI_SA_PCDec <- D2070$MI_County_PCDec*(DWRSA_Table$AVG/DWRSA_Table$`SUMS by County`)
#2150
D2150$MI_SA_PCDec <- D2150$MI_County_PCDec*(DWRSA_Table$AVG/DWRSA_Table$`SUMS by County`)
###With Per Capita Percent Changes  (Drastic Decrease (DD))#################################################################
#Decrease the Potable Use by 20%
DDPotable <- 0.80
#2015
D2015$DDPotable.Use <- D2015$Potable.Use * DDPotable
#2070
D2070$DDPotable.Use <- D2070$Potable.Use * DDPotable
#2150
D2150$DDPotable.Use <- D2150$Potable.Use * DDPotable
#Decrease the Secondary Use by 44%
DDSecondary <- (1 - 0.44)
#2015
D2015$DDSecondary.Use <- D2015$Secondary.Use * DDSecondary
#2070
D2070$DDSecondary.Use <- D2070$Secondary.Use * DDSecondary
#2150
D2150$DDSecondary.Use <- D2150$Secondary.Use * DDSecondary
######Calculate Demand Drastic Decreased Values##############################################################################
#Calculate Demand by County For 2015, 2070 and 2150
#2015
D2015$MI_County_PCDD <- ((D2015$Population*D2015$DDPotable.Use) + (D2015$Population*D2015$DDSecondary.Use))*GALtoAF
#2070
D2070$MI_County_PCDD <- ((D2070$Population*D2070$DDPotable.Use) + (D2070$Population*D2070$DDSecondary.Use))*GALtoAF
#2150
D2150$MI_County_PCDD <- ((D2150$Population*D2150$DDPotable.Use) + (D2150$Population*D2150$DDSecondary.Use))*GALtoAF
###Allocating Demand from County Demand to Service Area Proportionally From DWRSA_Table
#2015
D2015$MI_SA_PCDD <- D2015$MI_County_PCDD*(DWRSA_Table$AVG/DWRSA_Table$`SUMS by County`)
#2070
D2070$MI_SA_PCDD <- D2070$MI_County_PCDD*(DWRSA_Table$AVG/DWRSA_Table$`SUMS by County`)
#2150
D2150$MI_SA_PCDD <- D2150$MI_County_PCDD*(DWRSA_Table$AVG/DWRSA_Table$`SUMS by County`)
#----------------------------------- ###ET Scenario b. Increase to Usage due to ET (Increase Case)### --------------------------
###Calculate Demand_Initial Per Capita values###################################################################################
#Calculate Demand by County For 2015, 2070 and 2150
#2015
D2015$MI_County_ETInc <- ((D2015$Population*D2015$Potable.Use) + (D2015$Population*D2015$IncET_Secondary.Use ))*GALtoAF
#2070
D2070$MI_County_ETInc <- ((D2070$Population*D2070$Potable.Use) + (D2070$Population*D2070$IncET_Secondary.Use))*GALtoAF
#2150
D2150$MI_County_ETInc <- ((D2150$Population*D2150$Potable.Use) + (D2150$Population*D2150$IncET_Secondary.Use))*GALtoAF
####Allocating Demand from County Demand to Service Area Proportionally From DWRSA_Table
#2015
D2015$MI_SA_ETInc <- D2015$MI_County_ETInc*(DWRSA_Table$AVG/DWRSA_Table$`SUMS by County`)
#2070
D2070$MI_SA_ETInc <- D2070$MI_County_ETInc*(DWRSA_Table$AVG/DWRSA_Table$`SUMS by County`)
#2150
D2150$MI_SA_ETInc <- D2150$MI_County_ETInc*(DWRSA_Table$AVG/DWRSA_Table$`SUMS by County`)
###PerCapita Percent Changes (PCDecrease Scenario)#############################################################################
#Change The Input by ScenarioSA_PcntChanges
#Decrease the Potable Use by 10%
#DecPotable Values won't change with ET
#Decrease the Secondary Use by 34% to make total PerCapita reduction 25%
DecSecondary <- (1 - 0.34)
#2015
D2015$DecSecondary.Use_ETInc <- D2015$IncET_Secondary.Use * DecSecondary
#2070
D2070$DecSecondary.Use_ETInc <- D2070$IncET_Secondary.Use * DecSecondary
#2150
D2150$DecSecondary.Use_ETInc <- D2150$IncET_Secondary.Use * DecSecondary
######Calculate Demand Decreased Values########################################################################################
#Calculate Demand by County For 2015, 2070 and 2150
#2015
D2015$MI_County_PCDec_ETInc <- ((D2015$Population*D2015$DecPotable.Use) + (D2015$Population*D2015$DecSecondary.Use_ETInc))*GALtoAF
#2070
D2070$MI_County_PCDec_ETInc <- ((D2070$Population*D2070$DecPotable.Use) + (D2070$Population*D2070$DecSecondary.Use_ETInc))*GALtoAF
#2150
D2150$MI_County_PCDec_ETInc <- ((D2150$Population*D2150$DecPotable.Use) + (D2150$Population*D2150$DecSecondary.Use_ETInc))*GALtoAF
###Allocating Demand from County Demand to Service Area Proportionally From DWRSA_Table
#2015
D2015$MI_SA_PCDec_ETInc <- D2015$MI_County_PCDec_ETInc*(DWRSA_Table$AVG/DWRSA_Table$`SUMS by County`)
#2070
D2070$MI_SA_PCDec_ETInc <- D2070$MI_County_PCDec_ETInc*(DWRSA_Table$AVG/DWRSA_Table$`SUMS by County`)
#2150
D2150$MI_SA_PCDec_ETInc <- D2150$MI_County_PCDec_ETInc*(DWRSA_Table$AVG/DWRSA_Table$`SUMS by County`)
###With Per Capita Percent Changes  (Drastic Decrease (DD))####################################################################
#Decrease the Potable Use by 20%
#DDPotable Values won't change with ET
#Decrease the Secondary Use by 44%
DDSecondary <- (1 - 0.44)
#2015
D2015$DDSecondary.Use_ETInc <- D2015$IncET_Secondary.Use * DDSecondary
#2070
D2070$DDSecondary.Use_ETInc <- D2070$IncET_Secondary.Use * DDSecondary
#2150
D2150$DDSecondary.Use_ETInc <- D2150$IncET_Secondary.Use * DDSecondary
######Calculate Demand Drastic Decreased Values#################################################################################
#Calculate Demand by County For 2015, 2070 and 2150
#2015
D2015$MI_County_PCDD_ETInc <- ((D2015$Population*D2015$DDPotable.Use) + (D2015$Population*D2015$DDSecondary.Use_ETInc))*GALtoAF
#2070
D2070$MI_County_PCDD_ETInc <- ((D2070$Population*D2070$DDPotable.Use) + (D2070$Population*D2070$DDSecondary.Use_ETInc))*GALtoAF
#2150
D2150$MI_County_PCDD_ETInc <- ((D2150$Population*D2150$DDPotable.Use) + (D2150$Population*D2150$DDSecondary.Use_ETInc))*GALtoAF
###Allocating Demand from County Demand to Service Area Proportionally From DWRSA_Table
#2015
D2015$MI_SA_PCDD_ETInc <- D2015$MI_County_PCDD_ETInc*(DWRSA_Table$AVG/DWRSA_Table$`SUMS by County`)
#2070
D2070$MI_SA_PCDD_ETInc <- D2070$MI_County_PCDD_ETInc*(DWRSA_Table$AVG/DWRSA_Table$`SUMS by County`)
#2150
D2150$MI_SA_PCDD_ETInc <- D2150$MI_County_PCDD_ETInc*(DWRSA_Table$AVG/DWRSA_Table$`SUMS by County`)
#----------------------------------- ###ET Scenario c. Decrease to Usage due to ET (Decrease Case)### ----------------------------
###Calculate Demand_Initial Per Capita values#####################################################################################
#Calculate Demand by County For 2015, 2070 and 2150
#Conversion Factor Gallons per day to Acre-feet per year
GALtoAF <- 0.0000030688832459704*365
#2015
D2015$MI_County_ETDec <- ((D2015$Population*D2015$Potable.Use) + (D2015$Population*D2015$DecET_Secondary.Use))*GALtoAF
#2070
D2070$MI_County_ETDec <- ((D2070$Population*D2070$Potable.Use) + (D2070$Population*D2070$DecET_Secondary.Use))*GALtoAF
#2150
D2150$MI_County_ETDec <- ((D2150$Population*D2150$Potable.Use) + (D2150$Population*D2150$DecET_Secondary.Use))*GALtoAF
##Allocating Demand from County Demand to Service Area Proportionally From DWRSA_Table
#2015
D2015$MI_SA_ETDec <- D2015$MI_County_ETDec*(DWRSA_Table$AVG/DWRSA_Table$`SUMS by County`)
#2070
D2070$MI_SA_ETDec <- D2070$MI_County_ETDec*(DWRSA_Table$AVG/DWRSA_Table$`SUMS by County`)
#2150
D2150$MI_SA_ETDec <- D2150$MI_County_ETDec*(DWRSA_Table$AVG/DWRSA_Table$`SUMS by County`)
###PerCapita Percent Changes (PCDecrease Scenario)#################################################################################
#Change The Input by ScenarioSA_PcntChanges
#Decrease the Potable Use by 10%
#DecPotable Values won't change with ET
#Decrease the Secondary Use by 34% to make total PerCapita reduction 25%
DecSecondary <- (1 - 0.34)
#2015
D2015$DecSecondary.Use_ETDec <- D2015$DecET_Secondary.Use * DecSecondary
#2070
D2070$DecSecondary.Use_ETDec <- D2070$DecET_Secondary.Use * DecSecondary
#2150
D2150$DecSecondary.Use_ETDec <- D2150$DecET_Secondary.Use * DecSecondary
######Calculate Demand Decreased Values###########################################################################################
#Calculate Demand by County For 2015, 2070 and 2150
#2015
D2015$MI_County_PCDec_ETDec <- ((D2015$Population*D2015$DecPotable.Use) + (D2015$Population*D2015$DecSecondary.Use_ETDec))*GALtoAF
#2070
D2070$MI_County_PCDec_ETDec <- ((D2070$Population*D2070$DecPotable.Use) + (D2070$Population*D2070$DecSecondary.Use_ETDec))*GALtoAF
#2150
D2150$MI_County_PCDec_ETDec <- ((D2150$Population*D2150$DecPotable.Use) + (D2150$Population*D2150$DecSecondary.Use_ETDec))*GALtoAF
###Allocating Demand from County Demand to Service Area Proportionally From DWRSA_Table
#2015
D2015$MI_SA_PCDec_ETDec <- D2015$MI_County_PCDec_ETDec*(DWRSA_Table$AVG/DWRSA_Table$`SUMS by County`)
#2070
D2070$MI_SA_PCDec_ETDec <- D2070$MI_County_PCDec_ETDec*(DWRSA_Table$AVG/DWRSA_Table$`SUMS by County`)
#2150
D2150$MI_SA_PCDec_ETDec <- D2150$MI_County_PCDec_ETDec*(DWRSA_Table$AVG/DWRSA_Table$`SUMS by County`)
###With Per Capita Percent Changes  (Drastic Decrease (DD))########################################################################
#Decrease the Potable Use by 20%
#DDPotable Values won't change with ET
#Decrease the Secondary Use by 44%
DDSecondary <- (1 - 0.44)
#2015
D2015$DDSecondary.Use_ETDec <- D2015$DecET_Secondary.Use * DDSecondary
#2070
D2070$DDSecondary.Use_ETDec <- D2070$DecET_Secondary.Use * DDSecondary
#2150
D2150$DDSecondary.Use_ETDec <- D2150$DecET_Secondary.Use * DDSecondary
######Calculate Demand Drastic Decreased Values################################################################################
#Calculate Demand by County For 2015, 2070 and 2150
#2015
D2015$MI_County_PCDD_ETDec <- ((D2015$Population*D2015$DDPotable.Use) + (D2015$Population*D2015$DDSecondary.Use_ETDec))*GALtoAF
#2070
D2070$MI_County_PCDD_ETDec <- ((D2070$Population*D2070$DDPotable.Use) + (D2070$Population*D2070$DDSecondary.Use_ETDec))*GALtoAF
#2150
D2150$MI_County_PCDD_ETDec <- ((D2150$Population*D2150$DDPotable.Use) + (D2150$Population*D2150$DDSecondary.Use_ETDec))*GALtoAF
###Allocating Demand from County Demand to Service Area Proportionally From DWRSA_Table
#2015
D2015$MI_SA_PCDD_ETDec <- D2015$MI_County_PCDD_ETDec*(DWRSA_Table$AVG/DWRSA_Table$`SUMS by County`)
#2070
D2070$MI_SA_PCDD_ETDec <- D2070$MI_County_PCDD_ETDec*(DWRSA_Table$AVG/DWRSA_Table$`SUMS by County`)
#2150
D2150$MI_SA_PCDD_ETDec <- D2150$MI_County_PCDD_ETDec*(DWRSA_Table$AVG/DWRSA_Table$`SUMS by County`)
###     Outputs    ################################################################################################################
setwd("~/GitHub/WeberBasinVulnerability/WeberBasinVulnerability/1 - Scenario Processing/Annual Service Area Demand Scenarios/Output")
#  View(D2015)
#  View(D2070)
#  View(D2150)
#MI ONLY
MI_2015 <- D2015[,c(9,13,17,19,22,25,27,30,33)]
MI_2070 <- D2070[,c(9,13,17,19,22,25,27,30,33)]
MI_2150 <- D2150[,c(9,13,17,19,22,25,27,30,33)]
#add Utah County SA1 Data 35500 to top row
MI_2015[1,]<-35500
MI_2070[1,]<-35500
MI_2150[1,]<-35500
#add SA20 to be 0
MI_2015[20,]<-0
MI_2070[20,]<-0
MI_2150[20,]<-0
colnames(MI_2015) <- paste(colnames(MI_2015),"2015",sep="_")
colnames(MI_2070) <- paste(colnames(MI_2070),"2070",sep="_")
colnames(MI_2150) <- paste(colnames(MI_2150),"2150",sep="_")
MI<- data.frame(c(MI_2015,MI_2070,MI_2150))
View(MI)
#output to excel
write.xlsx(MI_2015, "MI_2015.xlsx")
write.xlsx(MI_2070, "MI_2070.xlsx")
write.xlsx(MI_2150, "MI_2150.xlsx")
write.xlsx(MI,"MI.xlsx")
#################################################################################################################################################################################################################################################################################################################################################################################################################################################
### Sum Data for plots ###
#################################################################################################################################################################################################################################################################################################################################################################################################################################################
#MI Sums
MISums <- colSums(MI,na.rm=F,dims = 1)
MISums
MISums <-data.frame(MISums)
#SummedScenarios <- data.frame(c(MI2015_Sums,MI2070_Sums,MI2150_Sums))
#row.names(SummedScenarios) <- c("Base","PCDec","PCDD","ETInc","PCDec_ETInc","PCDD_ETInc","ETDec","PCDec_ETDec","PCDD_ETDec")
#2015 Sums
MI2015_Sums <- colSums(MI_2015,na.rm = F, dims = 1)
MI2015_Sums <- data.frame(MI2015_Sums)
#MI2015_Sums$ET <-  c(rep('SameET',3),rep('DecreaseET',3),rep('IncreaseET',3))
#MI2015_Sums$PC <-  rep(c('SamePC','DecreasePC','DrasticDecreasePC'),3)
#MI2015_Sums$NUMPC <-  rep(c(3000,2000,1000),3)
#2070 Sums
MI2070_Sums <- colSums(MI_2070,na.rm = F, dims = 1)
MI2070_Sums <- data.frame(MI2070_Sums)
#MI2070_Sums$ET <- rep(c(rep('SameET',3),rep('DecreaseET',3),rep('IncreaseET',3)),3)
#MI2070_Sums$PC <- rep(rep(c('SamePC','DecreasePC','DrasticDecreasePC'),3),3)
#MI2070_Sums$NUMPC <- rep(rep(c(3000,2000,1000),3),3)
#2150 Sums
MI2150_Sums <- colSums(MI_2150,na.rm = F, dims = 1)
MI2150_Sums <- data.frame(MI2150_Sums)
#MI2150_Sums$ET <- rep(c(rep('SameET',3),rep('DecreaseET',3),rep('IncreaseET',3)),3)
#MI2150_Sums$PC <- rep(rep(c('SamePC','DecreasePC','DrasticDecreasePC'),3),3)
#MI2150_Sums$NUMPC <- rep(rep(c(3000,2000,1000),3),3)
SummedScenarios <- data.frame(c(MI2015_Sums,MI2070_Sums,MI2150_Sums))
row.names(SummedScenarios) <- c("Base","PCDec","PCDD","ETInc","PCDec_ETInc","PCDD_ETInc","ETDec","PCDec_ETDec","PCDD_ETDec")
RowNames <- c("Base","PCDec_ETSame","PCDrD_ETSame","PCBase_ETInc","PCDec_ETInc","PCDrD_ETInc","PCBase_ETDec","PCDec_ETDec","PCDrD_ETDec")
#################################################################################################################################################################################################################################################################################################################################################################################################################################################
### Plots ###
#################################################################################################################################################################################################################################################################################################################################################################################################################################################
#Barplots
Dates <- c("2015", "2070", "2150")
#Per Capita
plot_ly(data=SummedScenarios,x=RowNames, y= ~ MI2015_Sums ,type = 'bar',name = "2015") %>%
add_trace(x=RowNames, y= ~ MI2070_Sums,name = "2070") %>%
add_trace(x=RowNames,y = ~ MI2150_Sums, name = "2150") %>%
layout(yaxis=list(title = 'M&I Demand (acre-feet)',barmode = 'group'))
# *------------------------------------------------------------------
# | PROGRAM NAME: Approximated Agricultural Demand
# | FILE NAME: Demand_CalcbyServicaArea--Agricultural
# | DATE: 06/05/19
# | CREATED BY:  Jacob Everitt
# *----------------------------------------------------------------
# | PURPOSE:  Develop Approximate Demand Range of usage Agriculture for the Weber
# |Conservancy District.
# |
# |
# *------------------------------------------------------------------
# | STEPS:
# |  0:
# |  1:
# |  2:
# |  3:
# |  4:
# |  5:
# |  6:
# |  7:
# |  8:
# |  9:
# |  10:
# |
# |*------------------------------------------------------------------.
# | DATA USED:
# |
# |https://water.utah.gov/2015WaterData.pdf, December 21, 2018.
# |
# |https://water.utah.gov/OtherReports/MUNICIPAL%20AND%20INDUSTRIAL%20WATER%20USE%20in%20UTAH.pdf, December 21, 2018.
# |
# |https://conservewater.utah.gov/pdf/SamplePlans/WBWCD2013.pdf, December 21, 2018.
# |
# |https://weberbasin.com/, December 21, 2018
# |*------------------------------------------------------------------
# | CONTENTS:
# |  Part 0:
# |  PART 1:
# |  PART 2:
# |  PART 3:
# *-----------------------------------------------------------------
# | UPDATES:
# |
# |
# *------------------------------------------------------------------
### Clear any existing data or functions.
rm(list=ls())
#or not if run directly after Demand_Calc_byServiceArea--Municipal
#Set Working Directory
library(readxl)
setwd("~/GitHub/WeberBasinVulnerability/WeberBasinVulnerability/1 - Scenario Processing/Annual Service Area Demand Scenarios/Input_Data")
DWRSA_Table <- read_excel("DWRSA_Table.xlsx")
#Set Working Directory
setwd("~/GitHub/WeberBasinVulnerability/WeberBasinVulnerability/1 - Scenario Processing/Annual Service Area Demand Scenarios/Output")
##Possible package installation necessary
#install.packages("RColorBrewer")
#install.packages("plotly")
#install.packages("readxl")
#install.packages("openxlsx")
library(readxl)
library(plotly)
library(RColorBrewer)
library(openxlsx)
library("tibble", lib.loc="~/R/win-library/3.5")
##Input Data###############
MI_Same <- read_excel("MI_Same.xlsx")
MI_Same <- data.frame(MI_Same)
MI_Same[20,] <- 0
MI_2015<- read_excel("MI_2015.xlsx")
MI_2070<- read_excel("MI_2070.xlsx")
MI_2150<- read_excel("MI_2150.xlsx")
MI <- read_excel("MI.xlsx")
##Calculation##############
AGtoMI_CF <- c(0.65,0.72,0.78) #Agriculture to Municipal Water Use Conversion Factor
#-Change in Agriculture----------------------
#MI2070_SamePerCap - MI2015_SamePerCap = Changein_MI
Changein_MI_2070to2015 = MI_Same$X2070 - MI_Same$X2015
Changein_MI_2150to2015 = MI_Same$X2150 - MI_Same$X2015
##Changein_MI = Changein_AG "0.65AF = 1AF"
##Changein_AG = (Changein_MI/0.65)
#Conversion factor of  0.65
Changein_AG_2070to2015 = data.frame(Changein_MI_2070to2015/AGtoMI_CF[1])  #**put in while loop for differing conversion factors ?
Changein_AG_2150to2015 = data.frame(Changein_MI_2150to2015/AGtoMI_CF[1])
#Conversion factor of  0.72
Changein_AG_2070to2015[,2] = Changein_MI_2070to2015/AGtoMI_CF[2]
Changein_AG_2150to2015[,2] = Changein_MI_2150to2015/AGtoMI_CF[2]
#Conversion factor of 0.78
Changein_AG_2070to2015[,3] = Changein_MI_2070to2015/AGtoMI_CF[3]
Changein_AG_2150to2015[,3] = Changein_MI_2150to2015/AGtoMI_CF[3]
#Agricultural Base Usage--------
#BaseDemand <- data.frame(DWRSA_Table$MAX) #MAX AG WATER USE
BaseDemand <- data.frame(DWRSA_Table$AVG)    #OR AVG AG WATER USE
BaseDemand[20,] <- 0
AgBase2015 <- BaseDemand - MI_Same$X2015
#View(AgBase2015)
i=1
AG_2015 <- AgBase2015
AG_2070 <- data.frame(rep(1:20))
AG_2150 <- data.frame(rep(1:20))
while (i<=3) {
AG_2070[,i] <- data.frame(AgBase2015 - Changein_AG_2070to2015[,i])
AG_2150[,i] <- data.frame(AgBase2015 - Changein_AG_2150to2015[,i])
i=i+1
}
#ADD AG to MI ###############################
#MI + Base Ag
#2015 BaseDemand
MIandAg_Demand2015 <- data.frame(AG_2015[,1] + MI_2015[,1])
i=1
j=1
while (i<=ncol(MI_2015)) {
MIandAg_Demand2015[,j] <- AG_2015[,1] + MI_2015[,i]
i=i+1
j=j+1
}
#View(MIandAg_Demand2015)
#2070
MIandAg_Demand2070 <- data.frame(AG_2070[,1] + MI_2070[,1])
i=1
j=1
k=1
while (k<=3) {
while (i<=ncol(MI_2070)) {
MIandAg_Demand2070[,j] <- AG_2070[,k] + MI_2070[,i]
i=i+1
j=j+1
}
k=k+1
i=1
}
#View(MIandAg_Demand2070)
#2150
MIandAg_Demand2150 <- data.frame(AG_2150[,1] + MI_2150[,1])
i=1
j=1
k=1
while (k<=3) {
while (i<=ncol(MI_2150)) {
MIandAg_Demand2150[,j] <- AG_2150[,k] + MI_2150[,i]
i=i+1
j=j+1
}
k=k+1
i=1
}
#View(MIandAg_Demand2150)
#MIandAg_Demand Compilaton
MIandAg_Demand <- data.frame(c(MIandAg_Demand2015,MIandAg_Demand2070,MIandAg_Demand2150))
##Output Data############################################
write.xlsx(MIandAg_Demand,"MI_with_AG.xlsx")
#write.csv(MIandAg_Demand,"MI_with_AG.csv")
View(MIandAg_Demand)
#Tab----Workbook-----------
#Input How Many Scenarios                  #### Nine 2015 Scenarios, Twenty-Seven 2070 Scenarios, and Twenty-Seven 2150 Scenarios
#### 65 Total MI plus Ag Scenarios ########
RunNumber <- 27
#Create Workbook
wb <- createWorkbook("Data")
#Create Worksheet for each Run
for(Num in 1:(RunNumber)) {
RunsString <- paste0("Trace",Num)
addWorksheet(wb, RunsString)
}
#Input Data
SAs<- c('SA1','SA2','SA3','SA4','SA5','SA6','SA7','SA8','SA9','SA10','SA11','SA12','SA13','SA14','SA15','SA16','SA17','SA18','SA19','SA20')
i=1
while (i<=RunNumber) {
writeData(wb,sheet = i, SAs,startCol = 1,startRow = 3)
i=i+1
}
i=1
while (i<=RunNumber) {
writeData(wb,sheet = i, MIandAg_Demand[,i],startCol = 2,startRow = 3)
i=i+1
}
##Save workbook
saveWorkbook(wb,"MI+AG.xlsx",overwrite = TRUE)
#MI+Ag_Sums
SummedScenarios <- data.frame("Base","PCDec","PCDD","ETInc","PCDec_ETInc","PCDD_ETInc","ETDec","PCDec_ETDec","PCDD_ETDec")
#2015 Sums
MIAG2015_Sums <- colSums(MIandAg_Demand2015,na.rm = F, dims = 1)
MIAG2015_Sums <- data.frame(MIAG2015_Sums)
#MIAG2015_Sums$AGConversionFactor <- c(rep('65%'))
#MIAG2015_Sums$ET <-  c(rep('SameET',3),rep('DecreaseET',3),rep('IncreaseET',3))
#MIAG2015_Sums$PC <-  rep(c('SamePC','DecreasePC','DrasticDecreasePC'),3)
#MIAG2015_Sums$NUMPC <-  rep(c(3000,2000,1000),3)
#2070 Sums only taking into account 65% Conversion Factor
MIAG2070_Sums <- colSums(MIandAg_Demand2070[,1:9],na.rm = F, dims = 1)
MIAG2070_Sums <- data.frame(MIAG2070_Sums)
#MIAG2070_Sums$AGConversionFactor <- c(rep('65%',9),rep('72%',9),rep('78%',9))
#MIAG2070_Sums$ET <- rep(c(rep('SameET',3),rep('DecreaseET',3),rep('IncreaseET',3)),3)
#MIAG2070_Sums$PC <- rep(rep(c('SamePC','DecreasePC','DrasticDecreasePC'),3),3)
#MIAG2070_Sums$NUMPC <- rep(rep(c(3000,2000,1000),3),3)
#2150 Sums only taking into account 65% Conversion Factor
MIAG2150_Sums <- colSums(MIandAg_Demand2150[,1:9],na.rm = F, dims = 1)
MIAG2150_Sums <- data.frame(MIAG2150_Sums)
SummedScenarios <- data.frame(c(MIAG2015_Sums,MIAG2070_Sums,MIAG2150_Sums))
RowNames <- c("Base","PCDec_ETSame","PCDrD_ETSame","PCBase_ETInc","PCDec_ETInc","PCDrD_ETInc","PCBase_ETDec","PCDec_ETDec","PCDrD_ETDec")
plot_ly(data=SummedScenarios,x=RowNames, y= ~ MIAG2015_Sums ,type = 'bar',name = "2015") %>%
add_trace(x=RowNames, y= ~ MIAG2070_Sums,name = "2070") %>%
add_trace(x=RowNames,y = ~ MIAG2150_Sums, name = "2150") %>%
layout(yaxis=list(title = 'M&I + AG Demand (acre-feet)',barmode = 'group'))
AG_2150
AG_2150
AG_2015
AG_2070
AG_2150
AG_SUMS <- c(SUM(AG_2150))
sum(AG_2015)
sum(AG_2070)
AG_2070
sum(AG_2070[,1])
sum(AG_2070[1,])
sum(AG_2070[,2])
sum(AG_2070[,3])
AG_2015[,1]
AG_2015[,2]
AG_2015[,3]
AG_2015[2,]
AG_2015[,2]
AG_2015[,1]
AG_2070[,1]
AG_2070[,2]
AG_2070[,3]
AG_2150[,1]
Changein_AG)2150to2015
Changein_AG_2150to2015
AgBase2015
MI_Same
AG_2015
MI_2070+AG_2070
MI_2070[1,]+AG_2070[1,]
MI_2070[,1]+AG_2070[,1]
MI_2070[,2]+AG_2070[,2]
MI_2070[,3]+AG_2070[,3]
MI_2150[,3]+AG_2150[,3]
MI_2150[,2]+AG_2150[,2]
MI_2150[,1]+AG_2150[,1]
MI_2150[,2]+AG_2150[,2]
MI_2150[,1]+AG_2150[,1]
MI_2150[,1]+AG_2150[,1]
MI_2150[,2]+AG_2150[,2]
MI_2150[,1]+AG_2150[,1]
MI_2150[,1]+AG_2150[,1]
MI_2150[,3]+AG_2150[,3]
AG_2150
MI_2150
MIandAg_Demand2070
MIandAG_Demand2070 <- AG_2070+MI_2070
MIandAG_Demand2070[,2] <- AG_2070[,2]+MI_2070[,2]
MIandAG_D2070[,2] <- AG_2070[,2]+MI_2070[,2]
