#Iterate Flows in yearly segments of Average annual#######
### Clear any existing data or functions.
rm(list=ls())
## Linear Average looking forward 
setwd("~/GitHub/WeberRiverFlow_Calc")

#Input Data###############################################
library(readr)
weber2014 <- read_csv("weber2014_ac-ft.csv")
#View(weber2014)
#add on climate data######################################  
library(tidyverse)
library(readxl)
ClimateFlowsWeberRiver <- read_excel("ClimateFlowsWeberRiver.xlsx")
#View(ClimateFlowsWeberRiver)

ClimateFlowsWeberRiver <- ClimateFlowsWeberRiver[4:351,1:6]
data <- as_tibble(ClimateFlowsWeberRiver)
SumsofClimate <- c(1:29)

#Convert monthly climate data to annual data
i=1
j=1
k=2
while (k<=6) {
  while (i<=348) {
  SumsofClimate[j] <- sum(data[i:(i+11),k])  
    i=i+12
    j=j+1
  }
  i=1
   k=k+1
}

#Add data
weber2014 <- add_row(weber2014, X1 = 592:736,col_name = 'weber2014' ,year = 2020:2164, month = 1:1, recon_m3s = SumsofClimate, resolution = "annual" )
weber2014[577:591,8] <- weber2014[577:591,7]

#average specified yearly increments######################  
Weber_Annualflow <- weber2014$recon_m3s
#-1year------------------------------------------------------------------
i=1
j=1
k=1
L=k-1
m=round(736/k)
m

acft<-mean(Weber_Annualflow[i:(i)])

while (j<=m) {
  acft[j] <- mean(Weber_Annualflow[i:(i)])
  i=i+k
  j=j+1
}
acft
#-PLOT----------------------------------------------------------------------
years = 1429

i=1
j=2
l=1429

while (i<=m-1) {
  years[j] = l+k
  i=i+1  
  l=l+k
  j=j+1
}   

years

plot(years,acft, main= "1 Year")

#-Save DATA------------------------------------------------------------------
AA1 <- data.frame(c(1:m))
AA1$years <- years
AA1$acft <- acft
AA1$c.1.m. <- NULL

view(AA1)
#-2years------------------------------------------------------------------
i=1
j=1
k=2
L=k-1
m=round(736/k)-1
m

acft<-mean(Weber_Annualflow[i:(i+L)])

while (j<=m) {
  acft[j] <- mean(Weber_Annualflow[i:(i+L)])
  i=i+k
  j=j+1
}
acft
#-PLOT----------------------------------------------------------------------
years = 1429

i=1
j=2
l=1429

while (i<=m-1) {
  years[j] = l+k
  i=i+1  
  l=l+k
  j=j+1
}   

years

plot(years,acft, main= "2 Years")
#-DATA------------------------------------------------------------------
#SAVE DATA#
AA2 <- data.frame(c(1:m))
AA2$years <- years
AA2$acft <- acft
AA2$c.1.m. <- NULL

#view(AA2)
#-3years------------------------------------------------------------------
i=1
j=1
k=3
L=k-1
m=round(736/k)-1
m

acft<-mean(Weber_Annualflow[i:(i+L)])

while (j<=m) {
  acft[j] <- mean(Weber_Annualflow[i:(i+L)])
  i=i+k
  j=j+1
}
acft
#-PLOT----------------------------------------------------------------------
years = 1429

i=1
j=2
l=1429

while (i<=m-1) {
  years[j] = l+k
  i=i+1  
  l=l+k
  j=j+1
}   

years

plot(years,acft, main= "3 Years")
#-DATA------------------------------------------------------------------
#SAVE DATA#
AA3 <- data.frame(c(1:m))
AA3$years <- years
AA3$acft <- acft
AA3$c.1.m. <- NULL

#view(AA3)

#-4years------------------------------------------------------------------
i=1
j=1
k=4
L=k-1
m=round(736/k)-1
m

acft<-mean(Weber_Annualflow[i:(i+L)])

while (j<=m) {
  acft[j] <- mean(Weber_Annualflow[i:(i+L)])
  i=i+k
  j=j+1
}
acft
#-PLOT----------------------------------------------------------------------
years = 1429

i=1
j=2
l=1429

while (i<=m-1) {
  years[j] = l+k
  i=i+1  
  l=l+k
  j=j+1
}   

years

plot(years,acft, main= "4 Years")
#-DATA------------------------------------------------------------------
#SAVE DATA#
AA4<- data.frame(c(1:m))
AA4$years <- years
AA4$acft <- acft
AA4$c.1.m. <- NULL

#view(AA4)
#-5years------------------------------------------------------------------
i=1
j=1
k=5
L=k-1
m=round(736/k)-1
m

acft<-mean(Weber_Annualflow[i:(i+L)])

while (j<=m) {
  acft[j] <- mean(Weber_Annualflow[i:(i+L)])
  i=i+k
  j=j+1
}
acft
#-PLOT----------------------------------------------------------------------
years = 1429

i=1
j=2
l=1429

while (i<=m-1) {
  years[j] = l+k
  i=i+1  
  l=l+k
  j=j+1
}   

years

plot(years,acft, main= "5 Years")
#-DATA------------------------------------------------------------------
#SAVE DATA#
AA5<-data.frame(c(1:m))
AA5$years<-years
AA5$acft<-acft
AA5$c.1.m.<- NULL

#view(AA5)
#-10years------------------------------------------------------------------
i=1
j=1
k=10
L=k-1
m=round(736/k)-1
m

acft<-mean(Weber_Annualflow[i:(i+L)])

while (j<=m) {
  acft[j] <- mean(Weber_Annualflow[i:(i+L)])
  i=i+k
  j=j+1
}
acft
#-PLOT----------------------------------------------------------------------
years = 1429

i=1
j=2
l=1429

while (i<=m-1) {
  years[j] = l+k
  i=i+1  
  l=l+k
  j=j+1
}   

years

plot(years,acft, main= "10 Years")
#-DATA------------------------------------------------------------------
#SAVE DATA#
AA10<-data.frame(c(1:m))
AA10$years<-years
AA10$acft<-acft
AA10$c.1.m.<- NULL

#view(AA10)
#-15years------------------------------------------------------------------
i=1
j=1
k=15
L=k-1
m=round(736/k)-1
m

acft<-mean(Weber_Annualflow[i:(i+L)])

while (j<=m) {
  acft[j] <- mean(Weber_Annualflow[i:(i+L)])
  i=i+k
  j=j+1
}
acft
#-PLOT----------------------------------------------------------------------
years = 1429

i=1
j=2
l=1429

while (i<=m-1) {
  years[j] = l+k
  i=i+1  
  l=l+k
  j=j+1
}   

years

plot(years,acft,main= "15 Years")
#-DATA------------------------------------------------------------------
#SAVE DATA#
AA15<-data.frame(c(1:m))
AA15$years<-years
AA15$acft<-acft
AA15$c.1.m.<- NULL

#view(AA15)
#-20years------------------------------------------------------------------
i=1
j=1
k=20
m=round(736/k)-1
m

acft<-mean(Weber_Annualflow[i:(i+19)])

while (j<=m) {
  acft[j] <- mean(Weber_Annualflow[i:(i+19)])
  i=i+k
  j=j+1
}
acft
#-PLOT----------------------------------------------------------------------
years = 1429

i=1
j=2
l=1429

while (i<=m-1) {
 years[j] = l+k
i=i+1  
l=l+k
j=j+1
}   

years

plot(years,acft, main= "20 Years")
#-DATA------------------------------------------------------------------
#SAVE DATA#
AA20<-data.frame(c(1:m))
AA20$years<-years
AA20$acft<-acft
AA20$c.1.m.<- NULL

#view(AA20)
#-25years------------------------------------------------------------------
i=1
j=1
k=25
L=k-1
m=round(736/k)-1
m

acft<-mean(Weber_Annualflow[i:(i+L)])

while (j<=m) {
  acft[j] <- mean(Weber_Annualflow[i:(i+L)])
  i=i+k
  j=j+1
}
acft
#-PLOT----------------------------------------------------------------------
years = 1429

i=1
j=2
l=1429

while (i<=m-1) {
  years[j] = l+k
  i=i+1  
  l=l+k
  j=j+1
}   

years

plot(years,acft,main= "25 Years")
#-DATA------------------------------------------------------------------
#SAVE DATA#
AA25<-data.frame(c(1:m))
AA25$years<-years
AA25$acft<-acft
AA25$c.1.m.<- NULL

#view(AA25)  
#-30years------------------------------------------------------------------------  
i=1
j=1
k=30
m=round(736/k)-1
m

acft<- mean(Weber_Annualflow[i:(i+29)])

while (j<=m) {
  acft[j] <- mean(Weber_Annualflow[i:(i+29)])
  i=i+k
  j=j+1
  }

acft
#-PLOT--------------------------------------------------------
years = 1429

i=1
j=2
l=1429

while (i<=m-1) {
  years[j] = l+k
  i=i+1  
  l=l+k
  j=j+1
}   

years
plot(years,acft, main= "30 Years")
#-DATA------------------------------------------------------------------
#SAVE DATA#
AA30<-data.frame(c(1:m))
AA30$years<-years
AA30$acft<-acft
AA30$c.1.m.<- NULL

#view(AA30)
#-35years------------------------------------------------------------------
i=1
j=1
k=35
L=k-1
m=round(736/k)-1
m

acft<-mean(Weber_Annualflow[i:(i+L)])

while (j<=m) {
  acft[j] <- mean(Weber_Annualflow[i:(i+L)])
  i=i+k
  j=j+1
}
acft
#-PLOT----------------------------------------------------------------------
years = 1429

i=1
j=2
l=1429

while (i<=m-1) {
  years[j] = l+k
  i=i+1  
  l=l+k
  j=j+1
}   

years

plot(years,acft,main= "35 Years")
#-DATA------------------------------------------------------------------
#SAVE DATA#
AA35<-data.frame(c(1:m))
AA35$years<-years
AA35$acft<-acft
AA35$c.1.m.<- NULL

#view(AA35)
#-40years------------------------------------------------------------------
i=1
j=1
k=40
L=k-1
m=round(736/k)-1
m

acft<-mean(Weber_Annualflow[i:(i+L)])

while (j<=m) {
  acft[j] <- mean(Weber_Annualflow[i:(i+L)])
  i=i+k
  j=j+1
}
acft
#-PLOT----------------------------------------------------------------------
years = 1429

i=1
j=2
l=1429

while (i<=m-1) {
  years[j] = l+k
  i=i+1  
  l=l+k
  j=j+1
}   

years

plot(years,acft,main= "40 Years")
#-DATA------------------------------------------------------------------
#SAVE DATA#
AA40<-data.frame(c(1:m))
AA40$years<-years
AA40$acft<-acft
AA40$c.1.m.<- NULL

#view(AA40)
#-45years-------------------------------------------------------
i=1
j=1
k=45
L=k-1
m=round(736/k)-1
m

acft<-mean(Weber_Annualflow[i:(i+L)])

while (j<=m) {
  acft[j] <- mean(Weber_Annualflow[i:(i+L)])
  i=i+k
  j=j+1
}
acft
#-PLOT----------------------------------------------------------------------
years = 1429

i=1
j=2
l=1429

while (i<=m-1) {
  years[j] = l+k
  i=i+1  
  l=l+k
  j=j+1
}   

years

plot(years,acft,main= "45 Years")
#-DATA------------------------------------------------------------------
#SAVE DATA#
AA45<-data.frame(c(1:m))
AA45$years<-years
AA45$acft<-acft
AA45$c.1.m.<- NULL

#view(AA45)
#-50years------------------------------------------------------------------
i=1
j=1
k=50
m=round(736/k)-1
m

acft<- mean(Weber_Annualflow[i:(i+49)])

while (j<=m) {
  acft[j] <- mean(Weber_Annualflow[i:(i+49)])
  i=i+k
  j=j+1
}

acft
#-PLOT--------------------------------------------------------
years = 1429

i=1
j=2
l=1429

while (i<=m-1) {
  years[j] = l+k
  i=i+1  
  l=l+k
  j=j+1
}   

years

plot(years,acft, main= "50 Years")
#-DATA------------------------------------------------------------------
#SAVE DATA#
AA50<-data.frame(c(1:m))
AA50$years<-years
AA50$acft<-acft
AA50$c.1.m.<- NULL

#view(AA50)
#-60years------------------------------------------------------------------
i=1
j=1
k=60
m=round(736/k)-1
m

acft<- mean(Weber_Annualflow[i:(i+59)])

while (j<=m) {
  acft[j] <- mean(Weber_Annualflow[i:(i+59)])
  i=i+k
  j=j+1
}

acft
#-PLOT--------------------------------------------------------
years = 1429

i=1
j=2
l=1429

while (i<=m-1) {
  years[j] = l+k
  i=i+1  
  l=l+k
  j=j+1
}   

years

plot(years,acft, main= "60 Years")
#-DATA------------------------------------------------------------------
#SAVE DATA#
AA60<-data.frame(c(1:m))
AA60$years<-years
AA60$acft<-acft
AA60$c.1.m.<- NULL

#view(AA60)
#END OF PLOTS AND DATA CALC##############################

#ADDITIONAL PLOTS########################################
#line/scatterplots

#parallel plots
#install.packages("plot_ly")
#library(plotly)

#pp<- plot_ly(acft,x=)

#possibly sequence average flow plots.

end 

