#Combine all the column plots
plot_grid(colplots[[1]], colplots[[2]], colplots[[3]],
labels = dfStorageTargets$Subtitle,vjust = 4,  #Position the labels inside the top facet plot
ncol = 3, nrow = 1)
#Save the plot to file
ggsave("StorageReliability.jpg",width = 12.5,
height = 7.5, units = "in",
dpi = 300)
## FIGURE 7 -- Single plot for Sedmintation Rate == 0, Moderate level.
## Overplot the Flow/Demand combo Scenarios as black circles
## Add second left- top- axes to annotate flow and demand scenarios
dfPlotData1Frame <- dfPlotData %>% filter(Sedimentation == 0)
iTarget <- 1
sCurrCol <- paste0("`",cColNames[iTarget+16],"`",sep="")
pSingleLevel <- ggplot(dfPlotData1Frame, aes_string(x="Demand/1e3",y= "`Annual Avg Inflow`/1e3", z = sCurrCol)) +
#pSingleLevel <- ggplot(dfPlotData1Frame, aes(x=as.numeric(DemandFac)/1e3,y= `Annual Avg Inflow`/1e3, z = `Mod Reliability`)) +
#Fill Color
metR::geom_contour_fill(breaks = relBreaks ,na.fill = TRUE) +
#Contour lines
#metR::geom_contour2( colour = "black", binwidth=4, size=0.75, breaks = relBreaks)   +
metR::geom_contour2( colour = "black", size=0.75, breaks = relBreaks)   +
#Label contour lines (This is not working very well)
#metR::geom_text_contour(aes(label=..level..),size=6, check_overlap = TRUE, parse = TRUE) +
geom_dl(aes(label=..level..),method=list("angled.boxes", cex=2), stat="contour", breaks = relBreaks) +
#Overplot model scenario points
geom_point(size=4, color = "Black", shape=19) +
#Overplot historical point
geom_point(data= dfHistoricalPoint, aes(x = Demand/1e3, y = AnnualAvgFlow/1e3), color="Blue", size=4, shape = 15) +
# Label the points with reliability. Take out on final.
#geom_text(label=sprintf("%.0f",dfPlotData1Frame$`Mod Reliability`), size=5) +
#Add secondary x and y axis to label scenarios
scale_y_continuous(sec.axis = sec_axis(~. +0, name = "", breaks = dfFlowScenLabels$`Annual Avg Inflow`/1e3, labels = dfFlowScenLabels$FlowLabel)) +
scale_x_continuous(sec.axis = sec_axis(~. +0, name = "", breaks = dfDemScenLabels$Demand,  labels = format(dfDemScenLabels$Demand,digits=0))) +
#Fill the contours from white to the target color
scale_fill_gradientn(name = "Reliability",colours = c("White",as.character(dfStorageTargets$Color[iTarget])), na.value = "white") +
#Create the facets by sedimentation level
#facet_wrap( ~Sed, nrow = nSeds) +
theme_bw() +
guides(fill= "none") +
scale_size(guide="none") +
labs(x=AxisTitles[1], y=AxisTitles[2]) +
theme(text = element_text(size=18),
legend.position = "none")
print(pSingleLevel)
#Save the plot to file
ggsave("SingleReliability.jpg",width = 7,
height = 5, units = "in",
dpi = 300)
FlowTrace
dfFlowScenLabels <- dfPlotData %>% distinct(FlowTrace.x, `Annual Avg Inflow`,FlowLabel) %>% arrange(`Annual Avg Inflow`)
dfFlowScenLabels <- dfPlotData %>% distinct(FlowTrace.x, `Annual Avg Inflow`,FlowLabel.x) %>% arrange(`Annual Avg Inflow`)
dfDemScenLabels <- dfPlotData %>% distinct(DemTrace, Demand) %>% arrange(Demand)
dfDemScenLabels$Demand <- dfDemScenLabels$Demand/1e3
dfPlotData1Frame <- dfPlotData %>% filter(Sedimentation == 0)
iTarget <- 1
sCurrCol <- paste0("`",cColNames[iTarget+16],"`",sep="")
pSingleLevel <- ggplot(dfPlotData1Frame, aes_string(x="Demand/1e3",y= "`Annual Avg Inflow`/1e3", z = sCurrCol)) +
#pSingleLevel <- ggplot(dfPlotData1Frame, aes(x=as.numeric(DemandFac)/1e3,y= `Annual Avg Inflow`/1e3, z = `Mod Reliability`)) +
#Fill Color
metR::geom_contour_fill(breaks = relBreaks ,na.fill = TRUE) +
#Contour lines
#metR::geom_contour2( colour = "black", binwidth=4, size=0.75, breaks = relBreaks)   +
metR::geom_contour2( colour = "black", size=0.75, breaks = relBreaks)   +
#Label contour lines (This is not working very well)
#metR::geom_text_contour(aes(label=..level..),size=6, check_overlap = TRUE, parse = TRUE) +
geom_dl(aes(label=..level..),method=list("angled.boxes", cex=2), stat="contour", breaks = relBreaks) +
#Overplot model scenario points
geom_point(size=4, color = "Black", shape=19) +
#Overplot historical point
geom_point(data= dfHistoricalPoint, aes(x = Demand/1e3, y = AnnualAvgFlow/1e3), color="Blue", size=6, shape = 15) +
# Label the points with reliability. Take out on final.
#geom_text(label=sprintf("%.0f",dfPlotData1Frame$`Mod Reliability`), size=5) +
#Add secondary x and y axis to label scenarios
scale_y_continuous(sec.axis = sec_axis(~. +0, name = "", breaks = dfFlowScenLabels$`Annual Avg Inflow`/1e3, labels = dfFlowScenLabels$FlowLabel)) +
scale_x_continuous(sec.axis = sec_axis(~. +0, name = "", breaks = dfDemScenLabels$Demand,  labels = format(dfDemScenLabels$Demand,digits=0))) +
#Fill the contours from white to the target color
scale_fill_gradientn(name = "Reliability",colours = c("White",as.character(dfStorageTargets$Color[iTarget])), na.value = "white") +
#Create the facets by sedimentation level
#facet_wrap( ~Sed, nrow = nSeds) +
theme_bw() +
guides(fill= "none") +
scale_size(guide="none") +
labs(x=AxisTitles[1], y=AxisTitles[2]) +
theme(text = element_text(size=18),
legend.position = "none")
print(pSingleLevel)
pSingleLevel <- ggplot(dfPlotData1Frame, aes_string(x="Demand/1e3",y= "`Annual Avg Inflow`/1e3", z = sCurrCol)) +
#pSingleLevel <- ggplot(dfPlotData1Frame, aes(x=as.numeric(DemandFac)/1e3,y= `Annual Avg Inflow`/1e3, z = `Mod Reliability`)) +
#Fill Color
metR::geom_contour_fill(breaks = relBreaks ,na.fill = TRUE) +
#Contour lines
#metR::geom_contour2( colour = "black", binwidth=4, size=0.75, breaks = relBreaks)   +
metR::geom_contour2( colour = "black", size=0.75, breaks = relBreaks)   +
#Label contour lines (This is not working very well)
#metR::geom_text_contour(aes(label=..level..),size=6, check_overlap = TRUE, parse = TRUE) +
geom_dl(aes(label=..level..),method=list("angled.boxes", cex=2), stat="contour", breaks = relBreaks) +
#Overplot model scenario points
geom_point(size=4, color = "Blue", shape="Historical") +
#Overplot historical point
geom_point(data= dfHistoricalPoint, aes(x = Demand/1e3, y = AnnualAvgFlow/1e3), color="Blue", size=6, shape = "Historical") +
# Label the points with reliability. Take out on final.
#geom_text(label=sprintf("%.0f",dfPlotData1Frame$`Mod Reliability`), size=5) +
#Add secondary x and y axis to label scenarios
scale_y_continuous(sec.axis = sec_axis(~. +0, name = "", breaks = dfFlowScenLabels$`Annual Avg Inflow`/1e3, labels = dfFlowScenLabels$FlowLabel)) +
scale_x_continuous(sec.axis = sec_axis(~. +0, name = "", breaks = dfDemScenLabels$Demand,  labels = format(dfDemScenLabels$Demand,digits=0))) +
#Fill the contours from white to the target color
scale_fill_gradientn(name = "Reliability",colours = c("White",as.character(dfStorageTargets$Color[iTarget])), na.value = "white") +
scale_shape_manual(breaks=c("Historical", "Model"), values = c(15,19)) +
#Create the facets by sedimentation level
#facet_wrap( ~Sed, nrow = nSeds) +
theme_bw() +
guides(fill= "none") +
guides(marker = guide_legend(title="", order=1)) +
scale_size(guide="none") +
labs(x=AxisTitles[1], y=AxisTitles[2]) +
theme(text = element_text(size=18),
legend.position = "none")
print(pSingleLevel)
View(dfHistoricalPoint)
pSingleLevel <- ggplot(dfPlotData1Frame, aes_string(x="Demand/1e3",y= "`Annual Avg Inflow`/1e3", z = sCurrCol)) +
#pSingleLevel <- ggplot(dfPlotData1Frame, aes(x=as.numeric(DemandFac)/1e3,y= `Annual Avg Inflow`/1e3, z = `Mod Reliability`)) +
#Fill Color
metR::geom_contour_fill(breaks = relBreaks ,na.fill = TRUE) +
#Contour lines
#metR::geom_contour2( colour = "black", binwidth=4, size=0.75, breaks = relBreaks)   +
metR::geom_contour2( colour = "black", size=0.75, breaks = relBreaks)   +
#Label contour lines (This is not working very well)
#metR::geom_text_contour(aes(label=..level..),size=6, check_overlap = TRUE, parse = TRUE) +
geom_dl(aes(label=..level..),method=list("angled.boxes", cex=2), stat="contour", breaks = relBreaks) +
#Overplot model scenario points
geom_point(size=4, color = "Blue", shape=DataType) +
#Overplot historical point
geom_point(data= dfHistoricalPoint, aes(x = Demand/1e3, y = AnnualAvgFlow/1e3), color="Blue", size=6, shape = DataType) +
# Label the points with reliability. Take out on final.
#geom_text(label=sprintf("%.0f",dfPlotData1Frame$`Mod Reliability`), size=5) +
#Add secondary x and y axis to label scenarios
scale_y_continuous(sec.axis = sec_axis(~. +0, name = "", breaks = dfFlowScenLabels$`Annual Avg Inflow`/1e3, labels = dfFlowScenLabels$FlowLabel)) +
scale_x_continuous(sec.axis = sec_axis(~. +0, name = "", breaks = dfDemScenLabels$Demand,  labels = format(dfDemScenLabels$Demand,digits=0))) +
#Fill the contours from white to the target color
scale_fill_gradientn(name = "Reliability",colours = c("White",as.character(dfStorageTargets$Color[iTarget])), na.value = "white") +
scale_shape_manual(breaks=c("Historical", "Model"), values = c(15,19)) +
#Create the facets by sedimentation level
#facet_wrap( ~Sed, nrow = nSeds) +
theme_bw() +
guides(fill= "none") +
guides(marker = guide_legend(title="", order=1)) +
scale_size(guide="none") +
labs(x=AxisTitles[1], y=AxisTitles[2]) +
theme(text = element_text(size=18),
legend.position = "none")
print(pSingleLevel)
View(dfPlotData1Frame)
pSingleLevel <- ggplot(dfPlotData1Frame, aes_string(x="Demand/1e3",y= "`Annual Avg Inflow`/1e3", z = sCurrCol)) +
#pSingleLevel <- ggplot(dfPlotData1Frame, aes(x=as.numeric(DemandFac)/1e3,y= `Annual Avg Inflow`/1e3, z = `Mod Reliability`)) +
#Fill Color
metR::geom_contour_fill(breaks = relBreaks ,na.fill = TRUE) +
#Contour lines
#metR::geom_contour2( colour = "black", binwidth=4, size=0.75, breaks = relBreaks)   +
metR::geom_contour2( colour = "black", size=0.75, breaks = relBreaks)   +
#Label contour lines (This is not working very well)
#metR::geom_text_contour(aes(label=..level..),size=6, check_overlap = TRUE, parse = TRUE) +
geom_dl(aes(label=..level..),method=list("angled.boxes", cex=2), stat="contour", breaks = relBreaks) +
#Overplot model scenario points
geom_point(size=4, color = "Blue", shape = DataType) +
#Overplot historical point
geom_point(data= dfHistoricalPoint, aes(x = Demand/1e3, y = AnnualAvgFlow/1e3, shape = DataType), color="Blue", size=6) +
# Label the points with reliability. Take out on final.
#geom_text(label=sprintf("%.0f",dfPlotData1Frame$`Mod Reliability`), size=5) +
#Add secondary x and y axis to label scenarios
scale_y_continuous(sec.axis = sec_axis(~. +0, name = "", breaks = dfFlowScenLabels$`Annual Avg Inflow`/1e3, labels = dfFlowScenLabels$FlowLabel)) +
scale_x_continuous(sec.axis = sec_axis(~. +0, name = "", breaks = dfDemScenLabels$Demand,  labels = format(dfDemScenLabels$Demand,digits=0))) +
#Fill the contours from white to the target color
scale_fill_gradientn(name = "Reliability",colours = c("White",as.character(dfStorageTargets$Color[iTarget])), na.value = "white") +
scale_shape_manual(breaks=c("Historical", "Model"), values = c(15,19)) +
#Create the facets by sedimentation level
#facet_wrap( ~Sed, nrow = nSeds) +
theme_bw() +
guides(fill= "none") +
guides(marker = guide_legend(title="", order=1)) +
scale_size(guide="none") +
labs(x=AxisTitles[1], y=AxisTitles[2]) +
theme(text = element_text(size=18),
legend.position = "none")
print(pSingleLevel)
pSingleLevel <- ggplot(dfPlotData1Frame, aes_string(x="Demand/1e3",y= "`Annual Avg Inflow`/1e3", z = sCurrCol)) +
#pSingleLevel <- ggplot(dfPlotData1Frame, aes(x=as.numeric(DemandFac)/1e3,y= `Annual Avg Inflow`/1e3, z = `Mod Reliability`)) +
#Fill Color
metR::geom_contour_fill(breaks = relBreaks ,na.fill = TRUE) +
#Contour lines
#metR::geom_contour2( colour = "black", binwidth=4, size=0.75, breaks = relBreaks)   +
metR::geom_contour2( colour = "black", size=0.75, breaks = relBreaks)   +
#Label contour lines (This is not working very well)
#metR::geom_text_contour(aes(label=..level..),size=6, check_overlap = TRUE, parse = TRUE) +
geom_dl(aes(label=..level..),method=list("angled.boxes", cex=2), stat="contour", breaks = relBreaks) +
#Overplot model scenario points
geom_point(size=4, color = "Blue", shape = DataType) +
#Overplot historical point
geom_point(data= dfHistoricalPoint, aes(x = Demand/1e3, y = AnnualAvgFlow/1e3, shape = DataType), color="Blue", size=6) +
# Label the points with reliability. Take out on final.
#geom_text(label=sprintf("%.0f",dfPlotData1Frame$`Mod Reliability`), size=5) +
#Add secondary x and y axis to label scenarios
scale_y_continuous(sec.axis = sec_axis(~. +0, name = "", breaks = dfFlowScenLabels$`Annual Avg Inflow`/1e3, labels = dfFlowScenLabels$FlowLabel)) +
scale_x_continuous(sec.axis = sec_axis(~. +0, name = "", breaks = dfDemScenLabels$Demand,  labels = format(dfDemScenLabels$Demand,digits=0))) +
#Fill the contours from white to the target color
scale_fill_gradientn(name = "Reliability",colours = c("White",as.character(dfStorageTargets$Color[iTarget])), na.value = "white") +
#scale_shape_manual(breaks=c("Historical", "Model"), values = c(15,19)) +
#Create the facets by sedimentation level
#facet_wrap( ~Sed, nrow = nSeds) +
theme_bw() +
guides(fill= "none") +
guides(marker = guide_legend(title="", order=1)) +
scale_size(guide="none") +
labs(x=AxisTitles[1], y=AxisTitles[2]) +
theme(text = element_text(size=18),
legend.position = "none")
print(pSingleLevel)
pSingleLevel <- ggplot(dfPlotData1Frame, aes_string(x="Demand/1e3",y= "`Annual Avg Inflow`/1e3", z = sCurrCol)) +
#pSingleLevel <- ggplot(dfPlotData1Frame, aes(x=as.numeric(DemandFac)/1e3,y= `Annual Avg Inflow`/1e3, z = `Mod Reliability`)) +
#Fill Color
metR::geom_contour_fill(breaks = relBreaks ,na.fill = TRUE) +
#Contour lines
#metR::geom_contour2( colour = "black", binwidth=4, size=0.75, breaks = relBreaks)   +
metR::geom_contour2( colour = "black", size=0.75, breaks = relBreaks)   +
#Label contour lines (This is not working very well)
#metR::geom_text_contour(aes(label=..level..),size=6, check_overlap = TRUE, parse = TRUE) +
geom_dl(aes(label=..level..),method=list("angled.boxes", cex=2), stat="contour", breaks = relBreaks) +
#Overplot model scenario points
geom_point(size=4, color = "Blue", shape = as.factor(DataType)) +
#Overplot historical point
geom_point(data= dfHistoricalPoint, aes(x = Demand/1e3, y = AnnualAvgFlow/1e3, shape = as.factor(DataType)), color="Blue", size=6) +
# Label the points with reliability. Take out on final.
#geom_text(label=sprintf("%.0f",dfPlotData1Frame$`Mod Reliability`), size=5) +
#Add secondary x and y axis to label scenarios
scale_y_continuous(sec.axis = sec_axis(~. +0, name = "", breaks = dfFlowScenLabels$`Annual Avg Inflow`/1e3, labels = dfFlowScenLabels$FlowLabel)) +
scale_x_continuous(sec.axis = sec_axis(~. +0, name = "", breaks = dfDemScenLabels$Demand,  labels = format(dfDemScenLabels$Demand,digits=0))) +
#Fill the contours from white to the target color
scale_fill_gradientn(name = "Reliability",colours = c("White",as.character(dfStorageTargets$Color[iTarget])), na.value = "white") +
#scale_shape_manual(breaks=c("Historical", "Model"), values = c(15,19)) +
#Create the facets by sedimentation level
#facet_wrap( ~Sed, nrow = nSeds) +
theme_bw() +
guides(fill= "none") +
guides(marker = guide_legend(title="", order=1)) +
scale_size(guide="none") +
labs(x=AxisTitles[1], y=AxisTitles[2]) +
theme(text = element_text(size=18),
legend.position = "none")
print(pSingleLevel)
pSingleLevel <- ggplot(dfPlotData1Frame, aes_string(x="Demand/1e3",y= "`Annual Avg Inflow`/1e3", z = sCurrCol)) +
#pSingleLevel <- ggplot(dfPlotData1Frame, aes(x=as.numeric(DemandFac)/1e3,y= `Annual Avg Inflow`/1e3, z = `Mod Reliability`)) +
#Fill Color
metR::geom_contour_fill(breaks = relBreaks ,na.fill = TRUE) +
#Contour lines
#metR::geom_contour2( colour = "black", binwidth=4, size=0.75, breaks = relBreaks)   +
metR::geom_contour2( colour = "black", size=0.75, breaks = relBreaks)   +
#Label contour lines (This is not working very well)
#metR::geom_text_contour(aes(label=..level..),size=6, check_overlap = TRUE, parse = TRUE) +
geom_dl(aes(label=..level..),method=list("angled.boxes", cex=2), stat="contour", breaks = relBreaks) +
#Overplot model scenario points
geom_point(size=4, color = "Blue", shape = DataType) +
#Overplot historical point
geom_point(data= dfHistoricalPoint, aes(x = Demand/1e3, y = AnnualAvgFlow/1e3, shape = DataType), color="Blue", size=6) +
# Label the points with reliability. Take out on final.
#geom_text(label=sprintf("%.0f",dfPlotData1Frame$`Mod Reliability`), size=5) +
#Add secondary x and y axis to label scenarios
scale_y_continuous(sec.axis = sec_axis(~. +0, name = "", breaks = dfFlowScenLabels$`Annual Avg Inflow`/1e3, labels = dfFlowScenLabels$FlowLabel)) +
scale_x_continuous(sec.axis = sec_axis(~. +0, name = "", breaks = dfDemScenLabels$Demand,  labels = format(dfDemScenLabels$Demand,digits=0))) +
#Fill the contours from white to the target color
scale_fill_gradientn(name = "Reliability",colours = c("White",as.character(dfStorageTargets$Color[iTarget])), na.value = "white") +
scale_shape_manual(values = c(15,19)) +
#Create the facets by sedimentation level
#facet_wrap( ~Sed, nrow = nSeds) +
theme_bw() +
guides(fill= "none") +
guides(marker = guide_legend(title="", order=1)) +
scale_size(guide="none") +
labs(x=AxisTitles[1], y=AxisTitles[2]) +
theme(text = element_text(size=18),
legend.position = "none")
print(pSingleLevel)
pSingleLevel <- ggplot(dfPlotData1Frame, aes_string(x="Demand/1e3",y= "`Annual Avg Inflow`/1e3", z = sCurrCol)) +
#pSingleLevel <- ggplot(dfPlotData1Frame, aes(x=as.numeric(DemandFac)/1e3,y= `Annual Avg Inflow`/1e3, z = `Mod Reliability`)) +
#Fill Color
metR::geom_contour_fill(breaks = relBreaks ,na.fill = TRUE) +
#Contour lines
#metR::geom_contour2( colour = "black", binwidth=4, size=0.75, breaks = relBreaks)   +
metR::geom_contour2( colour = "black", size=0.75, breaks = relBreaks)   +
#Label contour lines (This is not working very well)
#metR::geom_text_contour(aes(label=..level..),size=6, check_overlap = TRUE, parse = TRUE) +
geom_dl(aes(label=..level..),method=list("angled.boxes", cex=2), stat="contour", breaks = relBreaks) +
#Overplot model scenario points
geom_point(size=4, color = "Blue", shape = dfPlotData1Frame$DataType) +
#Overplot historical point
geom_point(data= dfHistoricalPoint, aes(x = Demand/1e3, y = AnnualAvgFlow/1e3, shape = dfHistoricalPoint$DataType), color="Blue", size=6) +
# Label the points with reliability. Take out on final.
#geom_text(label=sprintf("%.0f",dfPlotData1Frame$`Mod Reliability`), size=5) +
#Add secondary x and y axis to label scenarios
scale_y_continuous(sec.axis = sec_axis(~. +0, name = "", breaks = dfFlowScenLabels$`Annual Avg Inflow`/1e3, labels = dfFlowScenLabels$FlowLabel)) +
scale_x_continuous(sec.axis = sec_axis(~. +0, name = "", breaks = dfDemScenLabels$Demand,  labels = format(dfDemScenLabels$Demand,digits=0))) +
#Fill the contours from white to the target color
scale_fill_gradientn(name = "Reliability",colours = c("White",as.character(dfStorageTargets$Color[iTarget])), na.value = "white") +
scale_shape_manual(values = c(15,19)) +
#Create the facets by sedimentation level
#facet_wrap( ~Sed, nrow = nSeds) +
theme_bw() +
guides(fill= "none") +
guides(marker = guide_legend(title="", order=1)) +
scale_size(guide="none") +
labs(x=AxisTitles[1], y=AxisTitles[2]) +
theme(text = element_text(size=18),
legend.position = "none")
print(pSingleLevel)
pSingleLevel <- ggplot(dfPlotData1Frame, aes_string(x="Demand/1e3",y= "`Annual Avg Inflow`/1e3", z = sCurrCol)) +
#pSingleLevel <- ggplot(dfPlotData1Frame, aes(x=as.numeric(DemandFac)/1e3,y= `Annual Avg Inflow`/1e3, z = `Mod Reliability`)) +
#Fill Color
metR::geom_contour_fill(breaks = relBreaks ,na.fill = TRUE) +
#Contour lines
#metR::geom_contour2( colour = "black", binwidth=4, size=0.75, breaks = relBreaks)   +
metR::geom_contour2( colour = "black", size=0.75, breaks = relBreaks)   +
#Label contour lines (This is not working very well)
#metR::geom_text_contour(aes(label=..level..),size=6, check_overlap = TRUE, parse = TRUE) +
geom_dl(aes(label=..level..),method=list("angled.boxes", cex=2), stat="contour", breaks = relBreaks) +
#Overplot model scenario points
geom_point(size=4, color = "Blue", shape = as.factor(dfPlotData1Frame$DataType)) +
#Overplot historical point
geom_point(data= dfHistoricalPoint, aes(x = Demand/1e3, y = AnnualAvgFlow/1e3, shape = as.factor(dfHistoricalPoint$DataType), color="Blue", size=6)) +
# Label the points with reliability. Take out on final.
#geom_text(label=sprintf("%.0f",dfPlotData1Frame$`Mod Reliability`), size=5) +
#Add secondary x and y axis to label scenarios
scale_y_continuous(sec.axis = sec_axis(~. +0, name = "", breaks = dfFlowScenLabels$`Annual Avg Inflow`/1e3, labels = dfFlowScenLabels$FlowLabel)) +
scale_x_continuous(sec.axis = sec_axis(~. +0, name = "", breaks = dfDemScenLabels$Demand,  labels = format(dfDemScenLabels$Demand,digits=0))) +
#Fill the contours from white to the target color
scale_fill_gradientn(name = "Reliability",colours = c("White",as.character(dfStorageTargets$Color[iTarget])), na.value = "white") +
scale_shape_manual(values = c(15,19)) +
#Create the facets by sedimentation level
#facet_wrap( ~Sed, nrow = nSeds) +
theme_bw() +
guides(fill= "none") +
guides(marker = guide_legend(title="", order=1)) +
scale_size(guide="none") +
labs(x=AxisTitles[1], y=AxisTitles[2]) +
theme(text = element_text(size=18),
legend.position = "none")
print(pSingleLevel)
pSingleLevel <- ggplot(dfPlotData1Frame, aes_string(x="Demand/1e3",y= "`Annual Avg Inflow`/1e3", z = sCurrCol)) +
#pSingleLevel <- ggplot(dfPlotData1Frame, aes(x=as.numeric(DemandFac)/1e3,y= `Annual Avg Inflow`/1e3, z = `Mod Reliability`)) +
#Fill Color
metR::geom_contour_fill(breaks = relBreaks ,na.fill = TRUE) +
#Contour lines
#metR::geom_contour2( colour = "black", binwidth=4, size=0.75, breaks = relBreaks)   +
metR::geom_contour2( colour = "black", size=0.75, breaks = relBreaks)   +
#Label contour lines (This is not working very well)
#metR::geom_text_contour(aes(label=..level..),size=6, check_overlap = TRUE, parse = TRUE) +
geom_dl(aes(label=..level..),method=list("angled.boxes", cex=2), stat="contour", breaks = relBreaks) +
#Overplot model scenario points
geom_point(size=4, color = as.factor(dfPlotData1Frame$DataType), shape = as.factor(dfPlotData1Frame$DataType)) +
#Overplot historical point
geom_point(data= dfHistoricalPoint, aes(x = Demand/1e3, y = AnnualAvgFlow/1e3, shape = as.factor(dfHistoricalPoint$DataType), color=as.factor(dfPlotData1Frame$DataType), size=6)) +
# Label the points with reliability. Take out on final.
#geom_text(label=sprintf("%.0f",dfPlotData1Frame$`Mod Reliability`), size=5) +
#Add secondary x and y axis to label scenarios
scale_y_continuous(sec.axis = sec_axis(~. +0, name = "", breaks = dfFlowScenLabels$`Annual Avg Inflow`/1e3, labels = dfFlowScenLabels$FlowLabel)) +
scale_x_continuous(sec.axis = sec_axis(~. +0, name = "", breaks = dfDemScenLabels$Demand,  labels = format(dfDemScenLabels$Demand,digits=0))) +
#Fill the contours from white to the target color
scale_fill_gradientn(name = "Reliability",colours = c("White",as.character(dfStorageTargets$Color[iTarget])), na.value = "white") +
scale_shape_manual(values = c(15,19)) +
scale_color_manual(values = c("Blue","Black")) +
#Create the facets by sedimentation level
#facet_wrap( ~Sed, nrow = nSeds) +
theme_bw() +
guides(fill= "none") +
guides(marker = guide_legend(title="", order=1)) +
scale_size(guide="none") +
labs(x=AxisTitles[1], y=AxisTitles[2]) +
theme(text = element_text(size=18),
legend.position = "none")
print(pSingleLevel)
pSingleLevel <- ggplot(dfPlotData1Frame, aes_string(x="Demand/1e3",y= "`Annual Avg Inflow`/1e3", z = sCurrCol)) +
#pSingleLevel <- ggplot(dfPlotData1Frame, aes(x=as.numeric(DemandFac)/1e3,y= `Annual Avg Inflow`/1e3, z = `Mod Reliability`)) +
#Fill Color
metR::geom_contour_fill(breaks = relBreaks ,na.fill = TRUE) +
#Contour lines
#metR::geom_contour2( colour = "black", binwidth=4, size=0.75, breaks = relBreaks)   +
metR::geom_contour2( colour = "black", size=0.75, breaks = relBreaks)   +
#Label contour lines (This is not working very well)
#metR::geom_text_contour(aes(label=..level..),size=6, check_overlap = TRUE, parse = TRUE) +
geom_dl(aes(label=..level..),method=list("angled.boxes", cex=2), stat="contour", breaks = relBreaks) +
#Overplot model scenario points
geom_point(size=4, color = "Black", shape = as.factor(dfPlotData1Frame$DataType)) +
#Overplot historical point
geom_point(data= dfHistoricalPoint, aes(x = Demand/1e3, y = AnnualAvgFlow/1e3, shape = as.factor(dfHistoricalPoint$DataType), color="Blue", size=6)) +
# Label the points with reliability. Take out on final.
#geom_text(label=sprintf("%.0f",dfPlotData1Frame$`Mod Reliability`), size=5) +
#Add secondary x and y axis to label scenarios
scale_y_continuous(sec.axis = sec_axis(~. +0, name = "", breaks = dfFlowScenLabels$`Annual Avg Inflow`/1e3, labels = dfFlowScenLabels$FlowLabel)) +
scale_x_continuous(sec.axis = sec_axis(~. +0, name = "", breaks = dfDemScenLabels$Demand,  labels = format(dfDemScenLabels$Demand,digits=0))) +
#Fill the contours from white to the target color
scale_fill_gradientn(name = "Reliability",colours = c("White",as.character(dfStorageTargets$Color[iTarget])), na.value = "white") +
scale_shape_manual(values = c(15,19)) +
#scale_color_manual(values = c("Blue","Black")) +
#Create the facets by sedimentation level
#facet_wrap( ~Sed, nrow = nSeds) +
theme_bw() +
guides(fill= "none") +
guides(marker = guide_legend(title="", order=1)) +
scale_size(guide="none") +
labs(x=AxisTitles[1], y=AxisTitles[2]) +
theme(text = element_text(size=18),
legend.position = "none")
print(pSingleLevel)
pSingleLevel <- ggplot(dfPlotData1Frame, aes_string(x="Demand/1e3",y= "`Annual Avg Inflow`/1e3", z = sCurrCol)) +
#pSingleLevel <- ggplot(dfPlotData1Frame, aes(x=as.numeric(DemandFac)/1e3,y= `Annual Avg Inflow`/1e3, z = `Mod Reliability`)) +
#Fill Color
metR::geom_contour_fill(breaks = relBreaks ,na.fill = TRUE) +
#Contour lines
#metR::geom_contour2( colour = "black", binwidth=4, size=0.75, breaks = relBreaks)   +
metR::geom_contour2( colour = "black", size=0.75, breaks = relBreaks)   +
#Label contour lines (This is not working very well)
#metR::geom_text_contour(aes(label=..level..),size=6, check_overlap = TRUE, parse = TRUE) +
geom_dl(aes(label=..level..),method=list("angled.boxes", cex=2), stat="contour", breaks = relBreaks) +
#Overplot model scenario points
geom_point(size=4, color = "Black", shape = as.factor(dfPlotData1Frame$DataType)) +
#Overplot historical point
geom_point(data= dfHistoricalPoint, aes(x = Demand/1e3, y = AnnualAvgFlow/1e3, shape = as.factor(dfHistoricalPoint$DataType), color="Blue", size=6)) +
# Label the points with reliability. Take out on final.
#geom_text(label=sprintf("%.0f",dfPlotData1Frame$`Mod Reliability`), size=5) +
#Add secondary x and y axis to label scenarios
scale_y_continuous(sec.axis = sec_axis(~. +0, name = "", breaks = dfFlowScenLabels$`Annual Avg Inflow`/1e3, labels = dfFlowScenLabels$FlowLabel)) +
scale_x_continuous(sec.axis = sec_axis(~. +0, name = "", breaks = dfDemScenLabels$Demand,  labels = format(dfDemScenLabels$Demand,digits=0))) +
#Fill the contours from white to the target color
scale_fill_gradientn(name = "Reliability",colours = c("White",as.character(dfStorageTargets$Color[iTarget])), na.value = "white") +
scale_shape_manual(values = c(19,15)) +
#scale_color_manual(values = c("Blue","Black")) +
#Create the facets by sedimentation level
#facet_wrap( ~Sed, nrow = nSeds) +
theme_bw() +
guides(fill= "none") +
guides(marker = guide_legend(title="", order=1)) +
scale_size(guide="none") +
labs(x=AxisTitles[1], y=AxisTitles[2]) +
theme(text = element_text(size=18),
legend.position = "none")
print(pSingleLevel)
pSingleLevel <- ggplot(dfPlotData1Frame, aes_string(x="Demand/1e3",y= "`Annual Avg Inflow`/1e3", z = sCurrCol)) +
#pSingleLevel <- ggplot(dfPlotData1Frame, aes(x=as.numeric(DemandFac)/1e3,y= `Annual Avg Inflow`/1e3, z = `Mod Reliability`)) +
#Fill Color
metR::geom_contour_fill(breaks = relBreaks ,na.fill = TRUE) +
#Contour lines
#metR::geom_contour2( colour = "black", binwidth=4, size=0.75, breaks = relBreaks)   +
metR::geom_contour2( colour = "black", size=0.75, breaks = relBreaks)   +
#Label contour lines (This is not working very well)
#metR::geom_text_contour(aes(label=..level..),size=6, check_overlap = TRUE, parse = TRUE) +
geom_dl(aes(label=..level..),method=list("angled.boxes", cex=2), stat="contour", breaks = relBreaks) +
#Overplot model scenario points
geom_point(size=4, color = "Black", shape = 19) +
#Overplot historical point
geom_point(data= dfHistoricalPoint, aes(x = Demand/1e3, y = AnnualAvgFlow/1e3, shape = 15, color="Blue", size=6)) +
# Label the points with reliability. Take out on final.
#geom_text(label=sprintf("%.0f",dfPlotData1Frame$`Mod Reliability`), size=5) +
#Add secondary x and y axis to label scenarios
scale_y_continuous(sec.axis = sec_axis(~. +0, name = "", breaks = dfFlowScenLabels$`Annual Avg Inflow`/1e3, labels = dfFlowScenLabels$FlowLabel)) +
scale_x_continuous(sec.axis = sec_axis(~. +0, name = "", breaks = dfDemScenLabels$Demand,  labels = format(dfDemScenLabels$Demand,digits=0))) +
#Fill the contours from white to the target color
scale_fill_gradientn(name = "Reliability",colours = c("White",as.character(dfStorageTargets$Color[iTarget])), na.value = "white") +
#scale_shape_manual(values = c(19,15)) +
#scale_color_manual(values = c("Blue","Black")) +
#Create the facets by sedimentation level
#facet_wrap( ~Sed, nrow = nSeds) +
theme_bw() +
guides(fill= "none") +
guides(marker = guide_legend(title="", order=1)) +
scale_size(guide="none") +
labs(x=AxisTitles[1], y=AxisTitles[2]) +
theme(text = element_text(size=18),
legend.position = "none")
print(pSingleLevel)
pSingleLevel <- ggplot(dfPlotData1Frame, aes_string(x="Demand/1e3",y= "`Annual Avg Inflow`/1e3", z = sCurrCol)) +
#pSingleLevel <- ggplot(dfPlotData1Frame, aes(x=as.numeric(DemandFac)/1e3,y= `Annual Avg Inflow`/1e3, z = `Mod Reliability`)) +
#Fill Color
metR::geom_contour_fill(breaks = relBreaks ,na.fill = TRUE) +
#Contour lines
#metR::geom_contour2( colour = "black", binwidth=4, size=0.75, breaks = relBreaks)   +
metR::geom_contour2( colour = "black", size=0.75, breaks = relBreaks)   +
#Label contour lines (This is not working very well)
#metR::geom_text_contour(aes(label=..level..),size=6, check_overlap = TRUE, parse = TRUE) +
geom_dl(aes(label=..level..),method=list("angled.boxes", cex=2), stat="contour", breaks = relBreaks) +
#Overplot model scenario points
geom_point(size=4, color = "Black", shape = 19) +
#Overplot historical point
geom_point(data= dfHistoricalPoint, aes(x = Demand/1e3, y = AnnualAvgFlow/1e3), shape = 15, color="Blue", size=6) +
# Label the points with reliability. Take out on final.
#geom_text(label=sprintf("%.0f",dfPlotData1Frame$`Mod Reliability`), size=5) +
#Add secondary x and y axis to label scenarios
scale_y_continuous(sec.axis = sec_axis(~. +0, name = "", breaks = dfFlowScenLabels$`Annual Avg Inflow`/1e3, labels = dfFlowScenLabels$FlowLabel)) +
scale_x_continuous(sec.axis = sec_axis(~. +0, name = "", breaks = dfDemScenLabels$Demand,  labels = format(dfDemScenLabels$Demand,digits=0))) +
#Fill the contours from white to the target color
scale_fill_gradientn(name = "Reliability",colours = c("White",as.character(dfStorageTargets$Color[iTarget])), na.value = "white") +
#scale_shape_manual(values = c(19,15)) +
#scale_color_manual(values = c("Blue","Black")) +
#Create the facets by sedimentation level
#facet_wrap( ~Sed, nrow = nSeds) +
theme_bw() +
guides(fill= "none") +
guides(marker = guide_legend(title="", order=1)) +
scale_size(guide="none") +
labs(x=AxisTitles[1], y=AxisTitles[2]) +
theme(text = element_text(size=18),
legend.position = "none")
print(pSingleLevel)
ggsave("SingleReliability.jpg",width = 7,
height = 5, units = "in",
dpi = 300)
